/**
***************************************************************************************************************************
*                                                                                                                         *
*                                          (C) 2025 ClassX - All Rights Reserved                                          *
*                                                                                                                         *
*                                           Official MixBoardÂ® Companion module                                           *
*                                                                                                                         *
***************************************************************************************************************************
*/
const { InstanceBase, TCPHelper, Regex, runEntrypoint, InstanceStatus } = require('@companion-module/base')

// Base64 compatibility
const atob = (data) => Buffer.from(data, 'base64').toString('utf8')
const btoa = (data) => Buffer.from(data).toString('base64')
const rgb = (r, g, b) => (r << 16) + (g << 8) + b

// def
const MAX_EXECUTE_BUTTON = 10
const MAX_ASSIGN_BUTTON = 16
const MAX_COMPO_LAYOUT = 8

// compositor execute button id 
const COMPO_SPEED_MODE_ID = 8
const COMPO_TRANSITION_MODE_ID = 9

// media playlist execute button id 
const MEDIAPLAYLIST_PREVMEDIA_ID = 0
const MEDIAPLAYLIST_REWIND_ID = 1
const MEDIAPLAYLIST_PLAYMEDIA_ID = 2
const MEDIAPLAYLIST_LOOPMEDIA_ID = 3
const MEDIAPLAYLIST_NEXTMEDIA_ID = 4

// mix composition execute button id 
const MIXCOMPOSITOR_CUT_ID = 0
const MIXCOMPOSITOR_FADE_ID = 1
const MIXCOMPOSITOR_TR1_ID = 2
const MIXCOMPOSITOR_TR2_ID = 3
const MIXCOMPOSITOR_TR3_ID = 4
const MIXCOMPOSITOR_TR4_ID = 5
const MIXCOMPOSITOR_RESUMEBACKWARD_ID = 8
const MIXCOMPOSITOR_RESUMEFORWARD_ID = 9

// mix composition assign button id 
const MIXCOMPOSITOR_PROGRAM_ID = 0
const MIXCOMPOSITOR_PREVIEW_ID = 1

// button color define
const COLOR_ORANGE = rgb(177, 98, 19)
const COLOR_GREEN = rgb(50, 216, 17)
const COLOR_WHITE = rgb(255, 255, 255)
const COLOR_BLACK = rgb(0, 0, 0)
const COLOR_RED = rgb(207, 0, 0)

// coming from ColorPalette.java
const CROSSPOINT_COLORS = [
	rgb(220, 8, 8), // Red (#dc0808)
	rgb(0, 172, 232), // Cyan (#00ace8)
	rgb(255, 100, 4), // Orange (#ff6404)
	rgb(72, 0, 164), // Purple (#4800a4)
	rgb(252, 244, 4), // Bright Yellow (#fcf404)
	rgb(0, 0, 212), // Blue (#0000d4)
	rgb(32, 184, 20), // Bright Green (#20b814)
	rgb(192, 192, 192), // Silver (#c0c0c0)
	rgb(240, 8, 132), // Pink (#f00884)
	rgb(0, 100, 16), // Dark Green (#006410)
	rgb(88, 44, 4), // Dark Brown (#582c04)
	rgb(64, 64, 64), // Dark Gray (#404040)
	rgb(144, 112, 56), // Brownish Yellow (#907038)
	rgb(128, 128, 128), // Gray (#808080)
	rgb(0, 0, 0), // Black (#000000)
	rgb(255, 255, 255), // White (#ffffff)
];

// list of crosspoint colored icons 
const CROSSPOINT_ICONS = [
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0klEQVR4Xu3QoRGAABDEwJf0Xx+9gERkmCG8jVhxkTczc2UFIQ5CnGecx5EPOnCpA5c6cKkDlzpw6fXA/IIQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRAi3Pp8gdeda4YvAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA00lEQVR4Xu3QsQ2AABDDwN9/FgZjC2iRLCTMty6uiMvMzFxZQYiDEOcxjjNfdOBSBy514FIHLnXg0uuB+QMhDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iBEuAEkS6VGthQVLwAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0klEQVR4Xu3QoRGAABDEwBeUSv8tgERkmCG8jVhxkTczc2UFIQ5CnGdc55EPOnCpA5c6cKkDlzpw6fXA/IIQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRAi3LU6VzoPXgmLAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0klEQVR4Xu3QoRGAABDEwC+PQukTJCLDDOFtxIqLvJmZKysIcRDiPOOYMx904FIHLnXgUgcudeDS64H5BSEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIES4AesegdfkHCRoAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1ElEQVR4Xu3QoQ6EABDE0BX8/9eeJAF5oiGhrK14YipnZubKCkIchDj/cf6OvNCBSx241IFLHbjUgUuPB+YThDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEOEGoqtL1TClG5wAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QsQ2AQBDEwOu/PvqBFMlCenOpgwnW4c7M3FlBiIMQ5z2uHOnApQ5c6sClDlzqwKXPA/MDQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiPAAy4ZYNzQTQ/kAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1klEQVR4Xu3QsQ2EABDEwCuCAr7/CugOwg8sJMylDiZYhzszc2UFIQ5CnP/4nUde6MClDlzqwKUOXOrApccD8wlCHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIcAOfjYHX05KuGwAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0klEQVR4Xu3QoRGAUBDE0Ou/qt8ZSESGGcLZiCc2cmdmrqwgxEGI84xzTj7owKUOXOrApQ5c6sCl1wPzC0IchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYhwA8VLz6XS50g9AAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1ElEQVR4Xu3QIRKEABDEwJU8/B7MD0CeSFFFWBvRYiJnZubKCkIchDj/cR6/vNCBSx241IFLHbjUgUuPB+YThDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEOEGIrB7pk/EsOEAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA00lEQVR4Xu3QsQ2AABDDwB+BIdl/BWiRLCTMty6uiMvMzFxZQYiDEOcxziNfdOBSBy514FIHLnXg0uuB+QMhDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iBEuAHh0rGoulbHLAAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1UlEQVR4Xu3QoRGFABDE0BOU8wui/0ZAfpFhhnA24omN3JmZKysIcRDi/Mf5O/JCBy514FIHLnXgUgcuPR6YTxDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkKEG/wm1FipK+JkAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0klEQVR4Xu3QoRGAUBDE0Cvt998USESGGcLZiCc2cmdmrqwgxEGI84xzTj7owKUOXOrApQ5c6sCl1wPzC0IchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYhwA85wNYfGEERDAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1ElEQVR4Xu3QsQ2EABDEwCuLsr4UOobwAwsJc6mDCdbhzsxcWUGIgxDnP87fkRc6cKkDlzpwqQOXOnDp8cB8ghAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxECLc9DsFtkyB6WcAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0ElEQVR4Xu3QIQ6AUBDE0D36vzlIRENCWVvxxFTOzMyVFYQ4CHGecc7JBx241IFLHbjUgUsduPR6YH5BiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIEW5J5YKWD9SuUQAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAvElEQVR4Xu3IoREAMBDDsOy/9HcAI1+pgYi27fIFEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEeEBUwroaS1vcnIAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QMQrAQAzEQP//05cyhTiI4lYLU1ilZ2ZOVhDiIMR5j/ZtPXC5HrhcD1yuBy7XA5e7PjC/IMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchAgPVtEXj0TlBNoAAAAASUVORK5CYII=',
];

// list of selected crosspoint colored icons 
const CROSSPOINT_SELECTED_ICONS = [
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0ElEQVR4Xu3QIQ6DABAAwUsw/JUv85fWIWhJgLUjxqzc2Zblw3tzDjxzDJwZHvg7cF9XbjAwMjAyMDIwMjC6HMh9PwN5x8DIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjA6AsLnX8NWhlfeAAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA2klEQVR4Xu3QsQ3DQBDEwC9SjagvFaYurFABbeDpSxkMsGC4ax3nJwMIcd6xYnw98LqzowOHOnCoA4c6cKgDh34emH04MP9BiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchCgPUigPdNnw95MAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QsQ2DABDAwI+UhdgpY2R36CgSkAC3V1zj0vNdXivPzW/gnn3gzHDD4cD18+YCAyMDIwMjAyMDo9OBXPc3kGcMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIw2DLO42+GmO4QAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0ElEQVR4Xu3QqxGDABQAwddLmomjyfRJHILPDHB2xZqTN59ZVt6bfeCZbeDM8MDpwO/8uMHAyMDIwMjAyMDociD3HQbyjoGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGB0R+3E5WthNLEBgAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QMQ6CABAAwTPxzTR+29IEOgvBBNh2imm23Hktj5X75jdwzXfgzHDB4cDP+8kJBkYGRgZGBkYGRn8Hct5uIPcYGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRhtLNmwUA/nrRoAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1ElEQVR4Xu3QsQ2AQBDEwO+WhukHQgKD9OZSByOtHO5a67gygRDnGVFeDzyzpQOHOnCoA4c6cKgDhz4PzD4cmH8Q4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIcYNbsxzHmM1p58AAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA00lEQVR4Xu3QIRaCABQAwV9NFg7gtbypt4NmEHwP2Dphysad5/uxct/8Bq75DpwZLjgc+PosnGBgZGBkYGRgZGD0dyDn7QZyj4GRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGB0QYG538N/zYh6AAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAzklEQVR4Xu3QoRHDQBDAwGv0e/3OYhYQxzO2RRcsEdSstT68N7+BZ74DZ4YH/g7ce3ODgZGBkYGRgZGB0eVA7jsN5B0DIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjA6MDm6l5fBp3I/oAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1ElEQVR4Xu3QsQ2CABQA0Z/YOBZLuYEDuwF0FoIJcO0rXnPlzeuxrNw3v4FrvgNnhgsOB36eb04wMDIwMjAyMDIw+juQ83YDucfAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwGgDa16/llKEIjcAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA2klEQVR4Xu3QoQ3DQBQE0WOmbsU9uf8WYmgwiXSTTwc8aTVw17qOTwYQ4rxjxfh64H1mRwcOdeBQBw514FAHDv08MPtwYP6DEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CFEeyx2k8/6KrP8AAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA00lEQVR4Xu3QsQ2CABQA0W/iCixhHMj9F4HOQjABrn3Fa668eS2PlfvmN3DNd+DMcMHhwM/7yQkGRgZGBkYGRgZGfwdy3m4g9xgYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGG2kznyy9dGSggAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAz0lEQVR4Xu3QoRHDQBDAwKvka/n+m4pZQBzP2BZdsERQs9b68N78Bp75DpwZHvg7cO/NDQZGBkYGRgZGBkaXA7nvNJB3DIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDvrNKj90WLWgAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1ElEQVR4Xu3QsRGCABAAwe/DPhwqsB5LsWPIDARngEs32OTCm9fzsXLf/Aau+Q6cGS44HPh5L5xgYGRgZGBkYGRg9Hcg5+0Gco+BkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgZGBkYGRgdEGhh1e2VF25HoAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAzklEQVR4Xu3QoRHDQBDAwKvsa/vOYxYQxzO2RRcsEdSstT68N7+BZ74DZ4YH/g7ce3ODgZGBkYGRgZGB0eVA7jsN5B0DIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjA6MDg3Tzxmhxqx4AAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAvElEQVR4Xu3IoREAMBDDsOy/9HcAI1+pgYi27fIFEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEeEBUwroaS1vcnIAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAzElEQVR4Xu3QKQ6AUBQEwXfwf3dwCJYEaFuTlBnZs9ba+G/OB98cAWeGD24D2rsJGCdgnIBxAsYJGPcYkPcuAflHwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBIwEjASMBoB8nv+e/MROmyAAAAAElFTkSuQmCC',
]

// icons
const OVERLAY_PROGRAM_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAB3RJTUUH6QgbDxIbszqFtwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAW1JREFUeNrt3FFqwlAQheFaxyRYpF2Bq3AZ2VeX6EZMoohaL3QF+R+Ggf+DvB8Od5wENZvtdvv7odXibc4OUVl0XTdlh6gsdrudBQLtBDrCgCMMtRH2BAKeQMgCIZcI1G6kPYFA9H3vCQTifXkCgc0wDNkZJK22+b+00md2gOosELJAyAKhOJ1O2RlKi3Ec3cKAIwxZIGSBUDyfz+wMpcX5fHaJAI4wZIGQBUIWCMWyLNkZSovL5eIWBhxhyAIhC4QsEIrj8ZidobQYhsEtDDjCkAVCFgjF9XrNzlBaexZ2iQCOMGSBkAVCFgjFPPsjfaJ9L+wWBhxhyAIhC4Riv99nZygtDoeDSwRwhCELhCwQskDIRzkoXq+XWxhwhCELhCwQisfjkZ2htLjf7y4RwBGG2puLuuwQlbUb6Z/sEJW1Ar+zQ1QW0zR5AoFWoCcQ8DMQan+0sUDAJQLF7Xb7yg5RWXsBo49ygI9ykAVCf1tYSlOzfrIjAAAAAElFTkSuQmCC'
const KEYLINK_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEp2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA2LTE4PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmMyNDA0MDcyLTg0NjEtNDZmMC1hOGE1LWJjZDgwMDJmODA1MDwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5UaXRvbG8gLSAxPC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJv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'
const HIGHLIGHT_CONTROL_VIDEOINPUT_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABT0lEQVR4Xu3cPU5CURRF4e0/Wr3EWjChwFBgkNBhfAkNFBhiQmuoKB0DA3CijkJDe151zq5M1km+Zperu83Vz/fkF3WKA3IIaCKgiYAmDQaDD9RpOByuUKfxePyKOk0mkxfUaTabPaFO8/n8AXVaLpf3qFPbtj3UieO4/35nsHQG5HQG5HQG5HQG5HQGZByPx3PUKQ7IURyQozggR3FAjna73QXqCGgioImAJgKaCGhS27aXqFMckKM4IEdxQI7igBzFATk6HA5XqCOgiYAmApoIaDq9ha9RR0ATAU0ENBHQRECT1uv1DeoIaCKgiYAmApq03+97qFMckKM4IEdxQI7igBzFATmnt/At6ghoIqCJgCYCmrTZbO5QR0CTttttgzqtVqtH1GmxWDyjTtPp9A11Go1G76hTv9//RJ2apvlCHd8gmwhoIqCJgCYCmv4A+p4mBoDK2XgAAAAASUVORK5CYII='
const COMPO_EASING_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAADBElEQVR4Xu2by2tTQRSHv8Qa0loRpDVSX7FEUBERdWsrUhERJJtiIerGgiAF/wM34kJcuXDhwoUrlyLoQtzY+kQsLtRuNFItaBXfxDa1TeqiRs490SaCd+ZmnI9ZnNzfuQk/5szcx2TA4/F4PB6PLWL6QJRJwHrohDSkoA1aoAWSkAQgDnHYoc+TRN5wE3TBPuiCzZDQ+m+IvKc/sBJOwVuY/cvWeCyBMzBZ5aTONi/R6/5uuAhr9GGAWRiDERiFN/AOCjABE1AEoAxluK3PizD9MF3VYx/hAmRhqU5vcI5XWX0J/dCsE52gD8rCaglOVy42DpKBr8JtAfbrFIeIwR3htgg9OsUtcsFx2691t2iCUeH2stado0+4nYS1WneOu8LwOS06R0ZcikqwTuthENcHTJITt7aD8CyoOsiwqOcjWnSODlHPM9Cm9ZCwV9K7RT0/gPdBNTTsGd4p4usidpa8GMDSvJu0C7dFo09Flkp6u4gfV95XGMGS4W0ifiji8LFkWPbwsIidZUyM4S1adA45Y03CQq2Hio2S3iTiEZgWH8PHtuEnIjaCN2wAq4aNE4MvYtJapXXnWC3cfrKwtmW8pGU9P4Vai33/HKuGbQxgbzhsbBs2SwKKYtIy9R7LHluF21daNIPZkrb3GPwLs4Yj8Bhsz7ClHjZIM0z9VzPWLuHW3jKSwZLuFvGQiM1i0PAeEd8UsZukoFSp5xIs17oxTPVwVvzUMIwHVYOYMpwT8RURu8kGsRRchk6tO8d5cUG6pUXnyATvN3q17hYxuCrc5mGBTnGLY8LtLBzQulvshe/C7aCFd5QG6Q1uWvgMaZ3iCovgbPDf3jOQ1VlOsBgG4HVw3JbhqE5scFbAQbgU/Ff7XJuCQzrdLrWmkR6Y298GJCtb31qhHTogDRthmT7pJ8/hMNzTh6ON6rE6WwFOQqv+skag2sz8bQxOQEp/TXSoVdL1LHZ9g0cwBNfgPpS1HilqGb5R2d8GFKFY2fr2AcZhFF5AHkr6PI/H4/F4PJ4qfgAuVil/9zLO9QAAAABJRU5ErkJggg=='
const COMPO_CUT_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAABcklEQVR4Xu3bv0oDQRDH8a+JYtBaEQQbqzS+gZ2FaGml4BPY+h4+hi8QtLD1EWysrYKlGPwbrQKTOQ6Eu9uRye/DFsNsYO/H3rHNBkRERCTKkm8UswvnMIQN6EPPzze17xuhzuAdfroc/8gOvFaer/VRo/U36Q9OYc33ion4hm/hcFZfwQi+YDr/m+bufSPOg3nx9vxkRs8m8Kaf7FrENzww9cTUaX2YHV7xk12L2OG+qb9NXUREYHsy1B+YHYkIHCriHLa7Wnz9hdthBc5OgbNT4OwUODsFzk6Bs1Pg7BQ4OwXOToGzU+DsFDg7Bc5OgbNT4OwUODsFzk6Bs1Pg7IoHLn4xyyke2Cp+7zAicOhFy4jAoVdpIwKvmvrN1KUUD7xu6oUIvGXqsalLqT8lDnyjqR4swxFczDo3cDz/m0jV/3q1Pi79mqGqz9fueIFtv2ao6iO2OCZw4hcso/4bvvONpqbwCWN4hGt48vMiIiKS3S+zMchbh4IbKQAAAABJRU5ErkJggg=='
const COMPO_SLOW_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAAELUlEQVR4Xu3bzW4bVRiA4Xds0okbp2mdOFKx20Crqimpu4AFv0IIiVtAqN6xRCyQSlXSvygF1KJWBRZcAVLgMlCBK0iiAuqChCSCOEmTOD+e0HpYfDh1TmJ7ZnzGnrHmWc6ZSH79zdiJfQKRSCQSiUQikUhjMfXAfnH1QEjFDGw4dYzkIdYtdbVK+INjBsDpFO+d4lyavzdY2lLPqeLgIgismIEBp4/x/gjvvkhft3rCQQz1QCjEDGybM/28cpxec8/SzzM8XNpzZK+wTVimeibFB+d55wW11oHwTFge6dkBXj5O8pC6uqsTJhw3ABJdXMzx9lC9WgeCHRw3MOBsP5leerroaSpVBDU4bhAzGB4gf4G3hjCfU0/wKnjBknouzcUcb57kcJd6QnOCFCypL6XJ53jjhJqq6eU1GMExg5jByCD5HK+fILFvqratq7jdwXGDuEFukHyO17IHpOrWvuAYxA3OD5K/wKutSBXtCJbfjobT/6d2a3sFdqK1wd2QgA8BGEm3OFW0KtiEw3AZ5uCmuthK/gdL6hWYh1uQUtcds9UDnvgZbEISRmEexuFo5bi8v7h6/Iae9yTfgrshCddgHsaqUpvh6gmqTXewCb1wHebhBhxR13k2YU0FLukL7oYjMAYLcK1GagDoCDahD27BAoxCUl1XebgfPfxIDc0Fm3AUvoB5uAw96noAeQ02IQV3YAE+dZkasnvYhH64A3PwCSTUdb9oen7cBJswAPeaTg3B+7AJg3Af5uBjcPSJd0A1CpbUb+Av+Kjyh06TPE7L1SVRU6Ng4AmU4Kl6OKQaBVuwAp9BFu5Dva+pwqFRsJDsq5CBu7Cprnvh6gr1eBccwFmwsGAVbsDzcBs21PVQcBMsLFiH8Up2UV1vTN+4PHAfLCwoVrI/h3V1PbC8BgsLNuBLyMA4rKrrB3N19+rWXLCQ7NuQgTHH2a7oe450BAsLtuAryMBNWFHXVW26k/UFC8m+C1m47iC75XQHixJswz3IwFVQvpHXd3164E+wsKAEX0MWrkBBXXdJzz3gZ7AogQXfQhYuwT+eJqzv0wL/g4UFO/AdnIRR8DAwt+fX0KpgIdnfAzBVYOtf9QT/tTZYyFbIR8tMTPLrrKNsbVd0W4JFGco2D5eYmOSXWTZ31BP80b5gUbYp2/wu2TP1skN5D9fy1MaG35aZmOTBDBv7sjtnj0e1so0NfyzzwyQPZihWbXvuhHu4lt3sH6f46c9Ktq1pwIHdIC4jfVxiapHiDsUdDBgeUE/bb3YtzBvEZdqPVljcZGOn/t5+h4I64Woy7SdlphdZs0gl6u2GaTThMARXW91musBqqWZ2pwXLtNdKTBd4fFB2pwWL3eypAsvbpBLPNvJ1ZrCQ7HWL6arsRsGdQv57aaiPbFA3l/hC0y8nkUgkEolEIhEv/gPsQhHiWq60zQAAAABJRU5ErkJggg=='
const COMPO_MEDIUM_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAAD/klEQVR4Xu3bXW8UVRzH8c9W2mmlPJUHg20sDxJj1Bu9N8boWzDGO4yaCERJlCDPATVAQBATvTDGC0zwhXjhG7Dx0gAtikUspUKnQOvFoU17oN3d6Wy7s5nv5fmd3dnv/s+ZM7N7hpKSkpKSkpKSkpLqtMUNj/JE3FBQ2iqm2LZOd4fRNE5nUXzhtgps7/HmNs9v9NeYG3fiPrOoYRA0LW0VFbav89YLXt9qTWfc4XFU4oZC0FYxNWXHeq9stiqZE/1y2e835rTMpWgVDlXd0ePtF722JbatgeJUOHzS5zZ4ebPujjidoRUqHOZmV7t3XvJq/0K2NdDcwgkr2MkbrGy3clGqgWYVTmjnA67wHevjPDPNJ5zQwYdc5hs2g6m4V2aaSbiTDnZzhfPTqoGp3E6vzSGckLCHq3zFU3FuKrcFZbmFg+rHXOUMm+I8d5ZPuINO9jLIaTbGeYNYDuFwdfQeg5xiQ5w3lKUV7qSLd8HuPBeb2lkq4YQn2ccgR+NwKWm8cFDdzxAn6InzmslnLW6kcEI3BxjiOGun28P6Mjm7azXyWZI0TLiTbg4xxLFZqoshnwLnLpywisMMcYTVcW6mXHUJNGOFO1nNMa5xaB7VzDSXcMIaTnCNA3THeUyB53DCWr5giH2sjPMmJKtwQg+nuMandaoWrMIJ6znFIHvpivNGUddJbn7qEU7YwNlFq2aocD0fc2Fqe6eETZxjkD3Tv6oVk2rCQfVrrrJr+kZnkWSocCW3MV1NGPcZ50HcXFCqCafc5DP6OMdCf1MVg2rCgaB9kF7O8F+cZ6GuEbo8y1LKCEd4mpOMxXkhqEc4kDLK8Wnt23FenfzKlYH6hQMpt6e1P2c0zpuWrMKBlDG+pJfjjMT546lr9ubN4oQDQfskvRyrWbsu8vuO8hAOpNzhNL0c5WacxyzTTM5POBC0z9DH4Rq0l5y8hQPj3OUsvRwk+kc+w/jM8JJ5aIxwIGWc8/Sxn+G5ad1HzmcO1H3Yuhkn5QJ9fML1TOWq605jQRovHEiZ4Fue4QAZjpxPges+7OII2j+BC/wZ5/OSYVDMw9IKB8JWyJ/p56PatIstHJjgHt/Tzx6G4nwOrSAcSLnHD2xhF4Nx/pBW2+ORcp8f2Tq9VSliMrezVnMIB4L2RbbxPpdnRcVblmon5QEX2c5O/qAFh/SjTPCASzzLTq7HeWaaVTgwwSSX+JWxiYX39tdIER4BCL8Q35808LdbqZ4unSviPjNcubXwIwBFEJ7NyF0Dw0bG59VuNeFwBXJr3MCwfx+n3WrCgRnt34b9c1dPl672h1FrCgeC9mhqYJZ2NeFWITy91L9GX76bS5qcnC5OSkpKSkpKSkpKsvA/1V/qN3snSVUAAAAASUVORK5CYII='
const COMPO_FAST_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAADgUlEQVR4Xu3aW28UZRzA4YfSdopWJBTx0GrxED+JiXdeGBNjNEaIGoVGSZRgOaaooaQIYqIXxniBiX4hjUaIBrotIRpCALFTDvXidZv2XUo709nt7nSe7NX73+7ub9+dTHY7VCqVSqVSqVQqy+uJFxptjBc6VC9zvMIw5+JhufTSxev8zhzvxfMSCalvco65+q2cwQkbeYs/FqSWMzik7rpXatmCu+nmHS40RJYtuA8MMdmQ13hbLrgrXmgrCd3s5AUeYyie59CuwQk9vMtFvmGADfFd8mm/4IRe3ucCX/E4mCtlcB+97OEip+upQdmCExJGmOQLHo3nJQoOqR8yyQTb43nh1i64lz72UuMEj8TzJlmL4AS8TY1xtsXzpmptcB+b2AX2MBDPW6BVwQkPsI8aR+JhKzU/OKTuZ4pjbI3nKzUXL+TTzOCEfkaZYowt9fVwgrm78K7LKeic1LTgPvo5yBRHF6SuRpvucMJDHGKKw2yO5+a3K1NAO+5wH5s5yjQHl0jNbUPGN2hpRQQnPMwxphmlP57HOvgYTtjCZ0yxjwfjeZHWeIcTtjLONB9nTO2wHU4YYJwae9kUz9tcluCEbZxcdWqOHc7yMu9vZY+UsJ1T1Bip/6rWmZYLDqlfMsnu+hedVcqxwy09Ld1mhjvxcodaLjjlCp8wxCluxvPWad0Oz2cfYJAJ/onneWQKWJvTUspVDvMEx7kRzztCluAg5Rpj9ezr8Xx5xW1XDtmDg5Tr9exPuRbP21be4CDlBp8zyBhX4/m9ZTp6i7a64CBkH2eQoyvOzqS496iI4CDlJicY5AhX4nks65Gc9f5LKC44CNkTDHFoBdktV3RwMMO/nGSQA/y9eJrj85njT5bQnOAgZYbTDLGfvxZPsz5zm36kG82QcoYhPuJyru3K9E3jvpofHKTM8jVPMUoLnznS2qcN2T+AM1yK50vq7P8Pp+AnhvlgZdmdHRzMcotvGWaEqXi+SI7DfglrFxyk3OI7drCbWjz/Xxl2eKGU23zP0/VLlSJ3SxYchOyzPFO/xHBeOYODlDuc5Vl28ifhI13QKy3oYQo3yx1+5Dl2crmwHe4EveBJztN4NWmpLi4NZsElnucNzsfzUuuhi9f4rWFvV7bDnSlkv8qv6yQ4CNkv88s6CQ7ms39eJ8FBDxt4iRfjSal1xwuVSqVSqVQqldb5D7qA8s4Uj0XKAAAAAElFTkSuQmCC'
const MEDIAPLAYLIST_PLAY_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAADE2AAAxNgGa50IgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAl5JREFUeJztnDFOFlEURg9IY0JILFwABZRaEPqxYQdU1oKJCa0uwRY6e2lwBdowFY2xwI5QsAAKShqTn4K8BVzvu+/e++adBbyZnHzz/2f+ENZWqxWD/2fd+wayMwQqGQKVDIFKhkAlQ6CSIVDJEKhEK3AXeF/jRrKiFbgFfAcugR397eSj1iM8AdfAZ+BFpTNTUPMz8CXwFfgD7Fc8NzQWXyJvgSvgFNg0OD8UVt/CG8AJ8Bc4MLpGCKwzZhv4CVwAr42v5UKrDjwEboCjRtdrRsuQfgV8o7Pk8XgTmegoebxe5bpJHu934fTJ4y0QkidPBIGFlMkTSWAhVfJEFAiJkieqwMJE8OSJLhCCJ08GgYWQyZNJIARMnmwCC2GSJ6vAgnvyZBcIzsnTg8DChEPy9CQQHJKnN4GFZsnTq0BolDw9CyyYJs8SBBZMkmdJAsEgeZYmsDBRKXmWKrAaG9434MTM82fhrfagpS3wATgG3lFBHixrgT+AT8B9zUOXIPAO+Aj8sji850f4H3AGvMFIHvS7wGvgA/Db+kK9LfAR+ALs0UAe9LXAmUppIqGHBVZPEwnZF2iSJhKyCjRNEwnZHuEmaSIh0wKbpYmEDAtsniYSoi9wxiFNJERdoGuaSIi4QPc0kRBJYJg0kRDhEQ6XJhK8FxgyTSR4LTB0mkjwWOBM8DSR0HKBadJEQqsFpkoTCdYCU6aJBKtHOHWaSLBYYPo0kVBzgd2kiYRaC5zpKE0krCn/i+8uz3/MfV7ndvKhFbh4IvyYkJohUMkQqGQIVDIEKhkClQyBSoZAJU+JcHmSJkE7YQAAAABJRU5ErkJggg=='
const MEDIAPLAYLIST_PAUSE_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAADE2AAAxNgGa50IgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAARNJREFUeJzt3LFNQzEUQNEXlII6QyC2yQjswQDswQhsgzJEarpPS4uPJYR0T//spyu59ek4jsm6h79e4L8rICogKiAqICogKiAqIDovzr3MzOuG+68z84lnPM/Mx4Zd3mbm/bdDqwEvM/O0OPvT46YzduxyWRnqCaMCogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICotW/s+4zc9tw/9emM3bscl8ZOvUNsukJowKiAqICogKiAqICogKib48JEJ/cgTlKAAAAAElFTkSuQmCC'
const MEDIAPLAYLIST_PLAYNEXT_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAADE2AAAxNgGa50IgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAApRJREFUeJzt3DHIjVEcx/HPy1uvQQZlUQZZJYNBshjEZmFCLNiwsWEzYrOSUgxsJOktiZIkqwzKogymd1DX8LjFoO695zzP+Z/H+dYd73n+93t/53nO7w53aTKZaCzOutID1E4TmEgTmEgTmEgTmEgTmEgTmEgTmEgTmEgTmMg8AlfwAJt7mmUI7mEyw2tl1gXnTeBRvMeBOd83WhbZwtvwHDfN8U2NlUXvgUs4j7fYlW+c+kh9iOzEG1zKsFaV5PjQG3AdT7A1w3pVkTM1B3UPmCMZ1wxP7m23BY9wBxszrx2Svu5bJ/EB+3paPwx93vi3YxVXsb7H6xSl7yfnMq7gJXb0fK0iDHX02It3ODvQ9QZjyLPbJtxWf5/+ixKH31H16VLtYTR9umT9GkWfjtBfp336gk5qVUQQSNenb+Cpyvp0FIFTquvT0QRSWZ+OKHBKFX06skAq6NPRBRK8T9cgcErIPl2TQAL26doETgnTp2sVSJA+XbNAAvTp2gVOKdanxyKwGMulB8jERxzXNZdBqT2BE9zCHgXkUXcCv+AUXpQcotYEPsRuheVRn8AfOIdj+F54FtS1hV/jBD6VHuRPakjgT1zDfsHkET+Bn3Wpe1V6kH8ROYF3dfUsrDxiJvAbzuBx6UFmIZrAZziNr4XnmJkoW3gNF3FIRfKIkcBiPTYHJRNYvMfmoFQCQ/TYHJRIYJgem4MhBYbrsTkYaguH7LE56DuBoXtsDvpMYPgem4O+ElhFj81B7gRW1WNzkFNgdT02Bzm28Bou47D/TB7pCay6x+Zg0QSOosfmYJEEjqbH5mDeBN7XHU+avN8stT+hTSPKL9LV0gQm0gQm0gQm0gQm0gQm0gQm0gQm0gQm0gQm8gu0JHQCMpfPVAAAAABJRU5ErkJggg=='
const MEDIAPLAYLIST_PLAYPREV_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAADE2AAAxNgGa50IgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAphJREFUeJzt3L2KFEEUhuFnF0GMxEQwMTDR0D8QVlAwEQM10sifTEO9BL0EDUUQ1hVEQwMxVHCjZTHUxMBEMBEDEUQdg6ZZQdCZOTVd1d31woRdfeblqy6+hpmlyWSiMj/LuQfoO1VgkCowSBUYpAoMUgUGqQKDVIFBqsAgVWCQWQRux2SKz6PEM3bJTjzUfNepqAncYgWbuDTLRVUg23ALr7BvnovHzAHNI+fwvAuMNYFLuIYNAXmMM4G7cR9nUyw2NoGn8QB7Ui04li28A3fwXEJ5jCOBR7GG/YtYfMgJXMYNvLYgeQw3gXuxipOLvtEQE3gBb3Qgj2EJbHvsE+zq6qZD2cIrGnkzV7EofU9gqMemGqCvhHtsCvqawCsS9NgU9C2BSXtsCvokMHmPTUEftvDCemwKSk/gQntsCkpNYCc9NgUlJrCzHpuC0hLYaY9NQSkCs/TYFJSwhbP12BTkTGD2HpuCXAksosemIEcCi+mxKSjlEOktOQSuahrGZoZ7JydXAt/iGG7jZ6YZkpBzC//QnMIn8D7jHCFKeAauaw6UtdyDzEMJAuELLuMiPmeeZSZKEdjyFAfxMvcg01KaQPiAU7iJ75ln+S8lCoRfmrfQx/Eu8yz/pFSBLRs4hLuaXwAUR+kC4Zvm7fQZfMw8y1/0QWDLC80B8yz3IH/SJ4HwCedwFV8zz4L+CWwppk/3VSCF9Ok+C6SAPt13gS3Z+vRQBJKpTw9JYEunfXqIAumwTw9VIB316SELbFlonx6DQBbYp8cisCV5nx6bQJo+fR7XJejTYxRI8yy8J0GfHqvAlnCfHrtAgn26CtxiHUfweJaLluqf0MaoCQxSBQapAoNUgUGqwCBVYJAqMEgVGKQKDFIFBvkNe0Byd5l1onIAAAAASUVORK5CYII='
const MEDIAPLAYLIST_REWIND_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAADE2AAAxNgGa50IgAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAA/RJREFUeJzt29uPXnMUxvHPmIkMMYgiIalToo6JSpyJqjinqiG4qCuS+g/oJYkL/QNccFEi2oQ664Wz3ozE4UITldBQh4QEbVChxBgXa96Stsb7zm+v/e4xv+/dvtjr2fPMXmvvtfZ6R6anp1XmzkHDvoD5TjWwkGpgIdXAQqqBhVQDC6kGFlINLKQaWEg1sJBqYCHVwEKqgYXMJwPPwHiyxolYNMgJ88HAQ/AYPsLjSRojuAef4v2Z474YS7qgpliMZ3D+zPGSBI3DsB63zhyfhIPxWz8nd9nAK/Akjk3UOBXP4uy5BuhiCo/gXrwu17wVeFeBeXTPwAk8hQcxmqTR+we9gCNLg3UphZeIdDorUeMobMS1TQXsyh14o0inTPOW4j0NmsfwDRzFfXgeRyTqrMYkTmk68DBTeJFIp2sSNcbwgKh5aQLDYKmodycnahwjXoOWJ2oMJYV76ZRp3qXYKtk82jVwTLyePIFDE3XW4E0cl6ixl7ZS+HhswiWJGuN4CHcmauxHGwZeJl6OM++IfXvm1shO4TV4Q655y8UEpXXzyDNwXEw4HhaTjQx6LdlrcnvmWclI4RNEOp2XELvHBB7FLYkafdG0gddhg+g5s1iC53BmokbfNJXCvXTaLNe8w0XP3AnzYKSBDdUJMXK/ufhqusO4libSp4mWrDN3RNuUpPBKvGMBm8fcDBwVLVn2CGpeMGgKHy1GUFcnXMu8ZNCHyDYLI2X7fogMmsL1RyX7MKiBy0TrVJlhUAN34nqsU+9GlL1IrxS7Kv/HJ3FaDfwnL+JCsfSzYCnthT/GRWL6siBpYpiwW2w2rcVUA/FmYwd+TNYYiKamMdPiwbICuxqKeSB+wgU6VDaanki/jHPFCkUWn4iy8XSiRt9kjPS/xOViYpzFbtymnbIxK1nfRPaIz4t34/ckjV7ZuArfJmn8J9lf5R7BlfgmUWOL+P6SWTb+lTY2EybFH/h2osZXomysT9Q4IG2tdnwt+uh1iRp7cJfcsrEfbe7G/CGK/h34JVGnjbKxl2FsZ20Q21M7EjUmcQ7eStTA8DZUPxCrGK8manwnljczy8ZQV3x34gbcjz+TNHplY7WksjHsHekpsSO9Sm6Pu1Gs1n3WdOBhG9jjJdHjbkvU2CrKxitNBu2KgUSPe7HcHneXmKiv1VDZ6JKBtNPj9lrAm/BDabCuGUh7Pe5mUTY+LAnSRQN7bJHf424XZWPTXAN02UCix13m7x9ab0/Q+Bm3i/W8KXxugFawifW2tjgdX+DXRI3FM/G/7/eE+WRgJ+l6CneeamAh1cBCqoGFVAMLqQYWUg0spBpYSDWwkGpgIdXAQqqBhVQDC/kL3a2rrjPrHgYAAAAASUVORK5CYII='
const MEDIAPLAYLIST_LOOPOFF_ICON = 'data:image/png;base64,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'
const MEDIAPLAYLIST_LOOPON_ICON = 'data:image/png;base64,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'

const MIXCOMPO_PROGRAM_SELECTED_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAyElEQVR4Xu3QKRKAQBDAwHk4fweH4KhaiG3RJjKzzez8N9fAN+fA4ZPHgTtLDIwMjAyMDIwMjF4Hsu42kH8MjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwMjAyMDIwOgIOY8OfWRN8AAAAASUVORK5CYII='
const MIXCOMPO_PROGRAM_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAz0lEQVR4Xu3QIQ7AQBDDwP3/p6+wwKpU31KDATHMzMzJCkIchDjvOPmlA5c6cKkDlzpwqQOXPg/MFYQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxDhAblPosvD14DUAAAAAElFTkSuQmCC'
const MIXCOMPO_PREVIEW_SELECTED_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1UlEQVR4Xu3QMQrAMAzF0By8d2/HDmogqldhHhiNf61r3RlAiPM+UT4H7M6uAYfXgMNrwOE14PAacHjbAXMOA+YfhDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYjyAM/8mPC41jWkAAAAAElFTkSuQmCC'
const MIXCOMPO_PREVIEW_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QMQrAQAzEQP//05c2IA6iuBXLFFbpmZmTFYQ4CHFeR/u2HrhcD1yuBy7XA5frgctdH5g/EOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQoQH/u2iy23/HdcAAAAASUVORK5CYII='

// see ANIMATION_SPEED enum
const ANIMATION_SPEED = [
	{ name: 'SLOW', icon: COMPO_SLOW_ICON },
	{ name: 'MEDIUM', icon: COMPO_MEDIUM_ICON },
	{ name: 'FAST', icon: COMPO_FAST_ICON },
]

// see TRANSITION_MODE enum
const TRANSITION_MODE = [
	{ name: 'EASING', icon: COMPO_EASING_ICON },
	{ name: 'CUT', icon: COMPO_CUT_ICON },
]

// see TRANSITION_STATUS enum
const TRANSITION_STATUS = Object.freeze({
	TRANSITION_STARTED: "TRANSITION_STARTED",
	TRANSITION_RUNNING: "TRANSITION_RUNNING",
	TRANSITION_PAUSED: "TRANSITION_PAUSED",
	TRANSITION_RESUMED: "TRANSITION_RESUMED",
	TRANSITION_FINISHED: "TRANSITION_FINISHED"
});

// see InputType enum
const INPUT_TYPE = Object.freeze({
	NONE: "NONE",
	AJA: "AJA",
	DECKLINK: "DECKLINK",
	BLUEFISH: "BLUEFISH",
	NDI: "NDI",
	LIBVLC: "LIBVLC",
	MEDIAPLAYLIST: "MEDIAPLAYLIST",
	SHAREDFRAME: "SHAREDFRAME",
	SPOUT: "SPOUT",
	CHROMIUM: "CHROMIUM",
	DIRECTSHOW: "DIRECTSHOW",
	COLORBARS: "COLORBARS",
	DUMMY: "DUMMY",
	MEDIAENGINE: "MEDIAENGINE",
	COMPOSITOR: "COMPOSITOR",
	MIXCOMPOSITOR: "MIXCOMPOSITOR"
});

// see TAKE_MODE enum
const TAKE_MODE = Object.freeze({
	CUT: { value: "CUT", isTransition: false },
	FADE: { value: "FADE", isTransition: false },
	TR1: { value: "TR1", isTransition: true },
	TR2: { value: "TR2", isTransition: true },
	TR3: { value: "TR3", isTransition: true },
	TR4: { value: "TR4", isTransition: true }
});

class MixBoardInstance extends InstanceBase {
	currentChannel = 'CH_0'

	constructor(internal) {
		super(internal)

		this.programVideoInputId = -1
		this.previewVideoInputId = -1
		this.maxVideoInput = 0;
		this.videoInputList = []
		this.keyerList = []
		this.dataCallback = []
		this.takeMode = []
		this.KEYER_STATUS = {
			// companion feedbacks
			STOPPED: 0,
			PLAY_TO_PROGRAM: 1,
			PLAY_TO_PREVIEW: 2,
		}

		this.CHANNEL_CHOICES = [
			{ id: 'CH_0', label: 'CH-0' },
			{ id: 'CH_1', label: 'CH-1' },
			{ id: 'CH_2', label: 'CH-2' },
			{ id: 'CH_3', label: 'CH-3' },
		]

		// generate from enum
		this.TAKEMODE_CHOICES = Object.values(TAKE_MODE).map(mode => ({
			id: mode.value,
			label: mode.value
		}));

		this.KEYER_CHOICES = [
			{ id: 0, label: 'BKGD' },
			{ id: 1, label: 'KEY1' },
			{ id: 2, label: 'KEY2' },
			{ id: 3, label: 'KEY3' },
			{ id: 4, label: 'KEY4' },
		]

		this.keyers = [
			'BKGD',
			'KEY1',
			'KEY2',
			'KEY3',
			'KEY4',
		]

		// the crosspoint videoinput id update from 'control_assign_crosspoint_action'
		this.crosspointVideoInputId = -1;

		// the transition status
		this.transitionStatus = ''

		// compositor control data
		this.compositorLayoutId = -1;
		this.compositorSelectedCrosspointId = -1;
		this.compositorLayoutNames = []
		this.compositorCrosspoints = []
		this.compositorSpeedIndex = 0
		this.compositorTransIndex = 0

		// media playlist control data
		this.mediaPlaylistLoopEnabled = false
		this.mediaPlaylistPaused = true

		// mix compositor control data
		this.mixCompositorTransitionStatus = TRANSITION_STATUS.TRANSITION_FINISHED
		this.mixCompositorSelectedCrosspointId = -1;
		this.mixCompositorProgram = 0
		this.mixCompositorPreview = 1
		this.mixCompositorTakeMode = TAKE_MODE.CUT

		// get transitions from enumeration
		this.mixCompositorTransitionNames = Object.values(TAKE_MODE)
			.filter(m => m.isTransition)
			.reduce((acc, m) => {
				acc[m.value] = m.value;
				return acc;
			}, {});

		// this.mixCompositortTransitionNames = {
		// 	TR1: 'TR1',
		// 	TR2: 'TR2',
		// 	TR3: 'TR3',
		// 	TR4: 'TR4',
		// };
	}

	async init(config) {
		this.config = config

		this.updateStatus(InstanceStatus.Ok)

		this.initActions()
		this.initFeedbacks()

		this.initTCP()
	}

	// When module gets deleted
	async destroy() {
		this.log('debug', 'destroy')

		if (this.socket) {
			this.socket.destroy()
			this.socket = null;
		}

		if (this.eventsocket) {
			this.eventsocket.destroy()
			this.eventsocket = null;
		}
	}

	async configUpdated(config) {
		this.config = config
		await this.init(config)
	}

	initTCP() {
		var ret = false;

		// dispose prev socket if present
		if (this.socket) {
			this.socket.destroy()
			this.socket = null
		}

		// dispose prev event socket if present
		if (this.eventsocket) {
			this.eventsocket.destroy()
			this.eventsocket = null
		}

		// fallback
		if (this.config.port === undefined) this.config.port = 701
		if (this.config.eventport === undefined) this.config.eventport = 801

		if (this.config.host) {
			this.socket = new TCPHelper(this.config.host, this.config.port)
			this.socket.on('status_change', (status) => this.updateStatus(status))
			this.socket.on('error', (err) => this.log('error', 'TCP error: ' + err))

			this.socket.on('connect', () => {
				this.updateStatus('ok')
				setTimeout(this.queryPresets.bind(this), 50)
				setTimeout(this.updateControlData.bind(this, this.config.control_videoinput_id), 50)
				setTimeout(this.updateMixBoardInfo.bind(this), 50)
			})

			this.socket.on('data', (tcpdata) => {
				if (this.config.protocollog) this.log('debug', 'MixBoard response: ' + tcpdata.toString())

				tcpdata
					.toString()
					.split('\n')
					.forEach((data) => {

						let dataStr = data.trim();

						if (dataStr == '') return
						if (dataStr.startsWith('Welcome to MixBoard')) return

						// handle callback if present
						if (this.dataCallback.length > 0) {
							this.dataCallback.shift()(dataStr)
						}
						else {
							// log to console
							this.log('error', 'Empty callback for this response: ' + dataStr)
						}
					})
			})
		}

		this.eventsocket = new TCPHelper(this.config.host, this.config.eventport)
		this.eventsocket.on('error', (err) => {
			this.log('error', 'Network error: ' + err.message)
		})

		this.eventsocket.on('data', data => {
			if (this.config.protocollog) this.log('debug', 'MixBoard response: ' + data.toString())
			this.tcpDataProcessor(data)
		})

		return ret;
	}

	/**
	 * Store a VideoInput by ID and return its saved parameters
	 * @param {any} videoInputId id of the VideoInput name
	 */
	getVideoInput(videoInputId) {
		if (videoInputId >= 0) {
			if (this.videoInputList[videoInputId] == null) {
				this.videoInputList[videoInputId] = {
					name: 'IN ' + videoInputId,
					type: 'NONE'
				}
			}
			return this.videoInputList[videoInputId]
		}
		else {
			return {
				name: 'IN ' + videoInputId,
				type: 'NONE'
			}
		}
	}

	/**
	 * Store a Keyer by ID and return its saved parameters
	 * @param {any} keyerId id of the keyer
	 * @returns 
	 */
	getKeyer(keyerId) {
		if (keyerId >= 0) {
			if (this.keyerList[keyerId] == null) this.keyerList[keyerId] = {
				status: this.KEYER_STATUS.STOPPED,
				linkEnabled: false
			}
			return this.keyerList[keyerId]
		} else return {
			status: this.KEYER_STATUS.STOPPED,
			linkEnabled: false
		}
	}

	/**
	 * Add keyer presets into the given preset list
	 * 
	 * @param {*} presets the preset list to update
	 */
	addKeyersPresets(presets) {
		// add keyer buttons
		this.keyers.forEach((keyer, index) => {
			const id = keyer.toLowerCase()
			presets[id] = {
				type: 'button',
				category: 'Keyers',
				name: keyer,
				style: {
					text: keyer,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [],

						500: [
							{
								actionId: 'keyer_action',
								options: {
									channel: null,
									keyer_id: index,
									play_to_prev: true
								},
							}
						],

						up: [
							{
								actionId: 'keyer_action',
								options: {
									channel: null,
									keyer_id: index,
									play_to_prev: false
								},
							}
						]

					},
				],
				feedbacks: [
					{
						feedbackId: 'program_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_RED,
						},
					},
					{
						feedbackId: 'preview_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_GREEN,
						},
					},
					{
						feedbackId: 'stopped_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_BLACK,
						},
					},
				],
			}

			presets[`${keyer.toLowerCase()}_link`] = {
				type: 'button',
				category: 'Keyers',
				name: `${keyer} Link`,
				style: {
					text: `${keyer}`,
					size: '14',
					color: COLOR_WHITE,
					png64: KEYLINK_ICON,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'keylink_tap_action',
								options: {
									channel: null,
									keyer_id: index,
								},
							}
						],
						up: []
					},
				],
				feedbacks: [
					{
						feedbackId: 'link_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_ORANGE
						},
					},
				],
			}
		})
	}

	/**
	 * Add transition presets into the given preset list
	 * 
	 * @param {*} presets the preset list to update
	 */
	addTransitionsPresets(presets) {

		// add transition actions
		for (const item of Object.values(TAKE_MODE)) {

			const takeMode = item.value
			const id = `take_${takeMode.toLowerCase()}`
			presets[id] = {
				type: 'button',
				category: 'Transitions',
				name: `Take ${takeMode}`,
				style: {
					text: `${takeMode}`,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'take_action',
								options: {
									channel: null,
									take_mode: takeMode,
								},
							},
						],
						up: [],
					},
				],
			}
		}

		// set take mode presets
		this.TAKEMODE_CHOICES.forEach(choice => {
			let takeMode = choice.id

			// auto take
			presets[`set_takemode_${takeMode}`] = {
				type: 'button',
				category: 'Transitions',
				name: `Set \n${takeMode}`,
				style: {
					text: `SET\n${takeMode}`,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'set_takemode_action',
								options: {
									channel: null,
									take_mode: takeMode,
								},
							},
						],
						up: [],
					},
				],
				feedbacks: [
					{
						feedbackId: 'takemode_changed',
						options: {
							take_mode: takeMode,
						},
						style: {
							bgcolor: COLOR_ORANGE
						},
					},
				],
			}
		});

		// auto take
		presets[`auto_take`] = {
			type: 'button',
			category: 'Transitions',
			name: `Auto Take`,
			style: {
				text: 'AUTO\nTAKE',
				size: '14',
				color: COLOR_WHITE,
				show_topbar: false
			},
			steps: [
				{
					down: [
						{
							actionId: 'autotake_action',
							options: {
								channel: null,
							},
						},
					],
					up: [],
				},
			],
		}

		// resume back
		presets[`resume_backward`] = {
			type: 'button',
			category: 'Transitions',
			name: `Resume Backward`,
			style: {
				text: `â®`,
				size: '18',
				color: COLOR_WHITE,
				show_topbar: false
			},
			steps: [
				{
					down: [
						{
							actionId: 'resume_action',
							options: {
								channel: null,
								play_direction: 'BACKWARD',
							},
						},
					],
					up: [],
				},
			],
			feedbacks: [
				{
					feedbackId: 'update_resume_button',
					options: {
					},
					style: {
						bgcolor: COLOR_ORANGE
					},
				},
			],
		}

		// resume forward
		presets[`resume_forward`] = {
			type: 'button',
			category: 'Transitions',
			name: `Resume Forward`,
			style: {
				text: `â­`,
				size: '18',
				color: COLOR_WHITE,
				show_topbar: false
			},
			steps: [
				{
					down: [
						{
							actionId: 'resume_action',
							options: {
								channel: null,
								play_direction: 'FORWARD',
							},
						},
					],
					up: [],
				},
			],
			feedbacks: [
				{
					feedbackId: 'update_resume_button',
					options: {
					},
					style: {
						bgcolor: COLOR_ORANGE
					},
				},
			],
		}
	}

	/**
	 * Add channel presets into the given preset list
	 * 
	 * @param {*} presets the preset list to update
	 */
	addChannelsPresets(presets) {
		this.CHANNEL_CHOICES.forEach((item) => {
			let id = item.id;
			let label = item.label
			presets[id] = {
				type: 'button',
				category: 'Channels',
				name: `${label}`,
				style: {
					text: `${label}`,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'channel_action',
								options: {
									channel: id.toString(),
								},
							},
						],
						up: [],
					},
				],
				feedbacks: [
					{
						feedbackId: 'channel_changed',
						options: {
							channel: id,
						},
						style: {
							bgcolor: COLOR_ORANGE
						},
					},
				],
			}
		})
	}

	/**
	 * Add "execute" buttons to preset list
	 * 
	 * @param {*} presets the preset list 
	 */
	addControlExecutePresets(presets) {
		for (let i = 0; i < MAX_EXECUTE_BUTTON; i++) {
			presets['execute_button_' + i] = {
				type: 'button',
				category: 'Control Execute',
				name: `Execute_` + i,
				style: {
					text: `Execute ` + i,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'control_execute_action',
								options: {
									execute_id: i,
								},
							},
						],
						up: [],
					},
				],

				feedbacks: [
					{
						feedbackId: 'update_execute_gui',
						options: {
							execute_id: i,
						},
					},
				],
			};
		}
	}

	/**
	 * Add the "assign" buttons to preset list
	 * 
	 * @param {*} presets  the preset list
	 */
	addControlAssignPresets(presets) {
		for (let i = 0; i < MAX_ASSIGN_BUTTON; i++) {
			let assignId = i

			presets['assign_button_' + i] = {
				type: 'button',
				category: 'Control Assign',
				name: `Assign_` + i,
				style: {
					text: `Assign ` + i,
					size: '14',
					color: COLOR_WHITE,
					png64: CROSSPOINT_ICONS[assignId],
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'control_assign_action',
								options: {
									assign_id: assignId,
								},
							},
						],
						up: [],
					},
				],

				feedbacks: [
					{
						feedbackId: 'update_assign_gui',
						options: {
							assign_id: assignId,
						},
					},
				],
			};
		}
	}

	/**
	 * Query contents from MixBoard and prepare a bank of presets
	 */
	queryPresets() {
		this.sendCommand(`MBC_GETVIDEOINPUTLIST`, (data) => {
			const presets = {}

			if (data.toString().trim() != '') {
				// register keyer presets
				this.addKeyersPresets(presets)

				// transitions presets
				this.addTransitionsPresets(presets)

				// channel presets
				this.addChannelsPresets(presets)

				// control presets
				this.addControlExecutePresets(presets)
				this.addControlAssignPresets(presets);

				// control the program videoinput
				presets['control_program'] = {
					type: 'button',
					category: 'Control Actions',
					name: `CONTROL PGM`,
					style: {
						text: 'CTRL PGM',
						size: '14',
						color: COLOR_WHITE,
						bgcolor: COLOR_BLACK,
						show_topbar: false
					},
					steps: [
						{
							down: [
								{
									actionId: 'control_program_input_action',
								},
							],
							up: [],
						},
					],
				}

				// control the preview videoinput
				presets['control_preview'] = {
					type: 'button',
					category: 'Control Actions',
					name: `CONTROL PVW`,
					style: {
						text: 'CTRL PVW',
						size: '14',
						color: COLOR_WHITE,
						bgcolor: COLOR_BLACK,
						show_topbar: false
					},
					steps: [
						{
							down: [
								{
									actionId: 'control_preview_input_action',
								},
							],
							up: [],
						},
					],
				}

				// parse json
				var jsonData = atob(data.toString().trim())
				const obj = JSON.parse(jsonData);

				this.maxVideoInput = parseInt(obj.MAX_SUPPORTED_INPUTS);

				obj.VIDEOINPUT.forEach((input) => {
					const inputName = input.NAME.toString()
					const inputType = input.TYPE.toString()
					const inputId = parseInt(input.VIDEOINPUTID)

					// update input name 
					var videoInput = this.getVideoInput(inputId)
					videoInput.name = inputName
					videoInput.type = inputType

					const pgmId = `pgm_in_${inputId}`
					presets[pgmId] = {
						type: 'button',
						category: 'Program',
						name: `PGM ${inputId}`,
						style: {
							text: inputName,
							size: '14',
							color: COLOR_WHITE,
							bgcolor: COLOR_BLACK,
							png64: OVERLAY_PROGRAM_ICON,
							show_topbar: false
						},
						steps: [
							{
								down: [
									{
										actionId: 'set_program_action',
										options: {
											channel: null,
											videoinput_id: inputId,
										},
									},
								],
								up: [],
							},
						],
						feedbacks: [
							{
								feedbackId: 'program_videoinput',
								options: {
									videoinput_id: inputId,
								},
								style: {
									bgcolor: COLOR_RED,
								},
							},
							{
								feedbackId: 'name_videoinput',
								options: {
									videoinput_id: inputId,
								},
							},
							{
								feedbackId: 'highlight_videoinput_control',
								options: {
									videoinput_id: inputId,
								},
								style: {
									png64: HIGHLIGHT_CONTROL_VIDEOINPUT_ICON
								},
							}
						],
					}

					const pvwId = `pvw_in_${inputId}`
					presets[pvwId] = {
						type: 'button',
						category: 'Preview',
						name: `PVW ${inputId}`,
						style: {
							text: inputName,
							size: '14',
							color: COLOR_WHITE,
							png64: OVERLAY_PROGRAM_ICON,
							show_topbar: false
						},
						steps: [
							{
								down: [
									{
										actionId: 'set_preview_action',
										options: {
											channel: null,
											videoinput_id: inputId,
										},
									},
								],
								up: [],
							},
						],
						feedbacks: [
							{
								feedbackId: 'preview_videoinput',
								options: {
									videoinput_id: inputId,
								},
								style: {
									bgcolor: COLOR_GREEN,
								},
							},
							{
								feedbackId: 'name_videoinput',
								options: {
									videoinput_id: inputId,
								},
							},
							{
								feedbackId: 'highlight_videoinput_control',
								options: {
									videoinput_id: inputId,
								},
								style: {
									png64: HIGHLIGHT_CONTROL_VIDEOINPUT_ICON
								},
							}
						],
					}

					const crbId = `crb_in_${inputId}`
					presets[crbId] = {
						type: 'button',
						category: 'Control VideoInput Crosspoints',
						name: `CRB ${inputId}`,
						style: {
							text: inputName,
							size: '14',
							color: COLOR_WHITE,
							bgcolor: COLOR_BLACK,
							show_topbar: false
						},
						steps: [
							{
								down: [
									{
										actionId: 'control_assign_crosspoint_action',
										options: {
											videoinput_id: inputId,
										},
									},
								],
								up: [],
							},
						],
						feedbacks: [
							{
								feedbackId: 'update_crosspoint_gui',
								options: {
									videoinput_id: inputId,
								},
								style: {
									bgcolor: COLOR_ORANGE,
								},
							},
							{
								feedbackId: 'name_videoinput',
								options: {
									videoinput_id: inputId,
								},
							},
						],
					}
				})

				// refresh input names
				this.checkFeedbacks('name_videoinput')
			}

			this.setPresetDefinitions(presets)
		})
	}

	/**
	 * Util to read parameters from event port
	 * @param {any} query event body
	 * @param {any} variable key to return
	 */
	getQueryVariable(query, variable) {
		const escapeRegExp = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');

		// (^|[\s,])   -> start of string, any whitespace, or a comma before the key
		// VAR\s*=\s*  -> key=value with optional spaces
		// "((?:\\.|[^"\\])*)" -> quoted value allowing \" escapes
		// |([^,\s]+)  -> or unquoted run up to comma or whitespace
		const re = new RegExp(
			`(?:^|[\\s,])${escapeRegExp(variable)}\\s*=\\s*(?:"((?:\\\\.|[^"\\\\])*)"|([^,\\s]+))`
		);

		const m = re.exec(query);
		if (!m) return null;

		// m[1] is quoted (with escapes), m[2] is unquoted
		if (m[1] !== undefined) {
			// unescape \" inside quoted strings
			return m[1].replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}
		return m[2];
	}

	/**
	* Process data recived by ClassX MixBoard instances
	* @param {any} data data received
	*/
	tcpDataProcessor(tcpdata) {
		tcpdata
			.toString()
			.split('\n')
			.forEach((data) => {
				if (data.trim() == '') return

				if (data.includes('Welcome to MixBoard')) return
				if (data.trim().startsWith('PING')) return
				if (data.trim().startsWith('Ok')) return

				// true if the event has not processed
				let unhandledEvent = false

				let dataStr = data.trim();

				if (dataStr.startsWith('MIXBOARDEVENT')) {
					let type = this.getQueryVariable(dataStr, 'TYPE')

					switch (type) {
						case 'CHANNEL_CHANGED': {
							if (this.config.linkChannelSelection) {
								let channel = this.getQueryVariable(dataStr, 'CHANNEL')
								this.currentChannel = channel

								// update gui
								this.updateMixBoardInfo()
							}
							break;
						}

						case 'PROGRAM_CHANGED': {
							let channel = this.getQueryVariable(dataStr, 'CHANNEL')

							// it must be the current channel 
							if (channel !== this.currentChannel) return

							let videoInputId = parseInt(this.getQueryVariable(dataStr, 'VIDEOINPUTID'))

							// update program video input id
							this.programVideoInputId = videoInputId;

							this.checkFeedbacks('program_videoinput');
							break;
						}

						case 'PREVIEW_CHANGED': {
							let channel = this.getQueryVariable(dataStr, 'CHANNEL')

							// it must be the current channel 
							if (channel !== this.currentChannel) return

							let videoInputId = parseInt(this.getQueryVariable(dataStr, 'VIDEOINPUTID'))

							// update status
							this.previewVideoInputId = videoInputId;

							// check feedbacks	
							this.checkFeedbacks('preview_videoinput');
							break;
						}

						case 'TRANSITION_STATUS_CHANGED': {
							let channel = this.getQueryVariable(dataStr, 'CHANNEL')
							let status = this.getQueryVariable(dataStr, 'STATUS').toString().trim()

							// it must be the current channel 
							if (channel !== this.currentChannel) return

							// store new status
							this.transitionStatus = status

							switch (status) {
								case TRANSITION_STATUS.TRANSITION_FINISHED:
									this.updateMixBoardInfo()
									break

								case TRANSITION_STATUS.TRANSITION_RESUMED:
								case TRANSITION_STATUS.TRANSITION_PAUSED:
									// highlight resume buttons according with transition status
									this.checkFeedbacks('update_resume_button')
									break
							}
							break;
						}

						case 'KEYER_STATUS_CHANGED': {
							let channel = this.getQueryVariable(dataStr, 'CHANNEL')
							let keyerId = parseInt(this.getQueryVariable(dataStr, 'KEYERID'))
							let status = this.getQueryVariable(dataStr, 'STATUS').toString().trim()

							// it must be the current channel 
							if (channel !== this.currentChannel) return

							switch (status) {
								case 'PLAY_TO_PREVIEW':
									this.getKeyer(keyerId).status = this.KEYER_STATUS.PLAY_TO_PREVIEW
									break;
								case 'PLAY_TO_PROGRAM':
									this.getKeyer(keyerId).status = this.KEYER_STATUS.PLAY_TO_PROGRAM
									break;
								case 'STOP':
									this.getKeyer(keyerId).status = this.KEYER_STATUS.STOPPED
									break;
							}

							this.checkFeedbacks('stopped_keyer', 'preview_keyer', 'program_keyer')
							break;
						}

						case 'KEYER_TRANSITIONLINK_CHANGED': {
							let channel = this.getQueryVariable(dataStr, 'CHANNEL')
							let keyerId = parseInt(this.getQueryVariable(dataStr, 'KEYERID'))
							let link = this.getQueryVariable(dataStr, 'LINK').toLowerCase() === 'true'

							// it must be the current channel 
							if (channel !== this.currentChannel) return

							this.getKeyer(keyerId).linkEnabled = link

							this.checkFeedbacks('link_keyer')
							break;
						}

						default:
							unhandledEvent = true
							break;
					}
				}
				else if (dataStr.startsWith('VIDEOINPUTEVENT')) {
					let videoInputId = parseInt(this.getQueryVariable(dataStr, 'VIDEOINPUTID'))
					let type = this.getQueryVariable(dataStr, 'TYPE')
					let value = this.getQueryVariable(dataStr, 'VALUE')

					let controlVideoInputId = this.config.control_videoinput_id
					let isControlVideoInput = videoInputId == controlVideoInputId

					// refresh presets
					switch (type) {
						case 'NAME_CHANGED':
							this.queryPresets();
							break

						case 'VIDEOINPUT_CHANGED':
							this.queryPresets();
							this.updateControlData(controlVideoInputId);
							break

						case 'COMPOSITOR_LAYOUTCHANGED':
							if (isControlVideoInput) {
								this.compositorLayoutId = value
								this.checkFeedbacks('update_execute_gui')
								this.sendCommand(`UPDATEGUI`)
							}
							break

						case 'COMPOSITOR_ANIMATION_SPEED_CHANGED':
							if (isControlVideoInput) {
								this.compositorSpeedIndex = ANIMATION_SPEED.findIndex(item => item.name === value)
								this.checkFeedbacks('update_execute_gui')
								this.sendCommand(`UPDATEGUI`)
							}
							break

						case 'COMPOSITOR_TRANSITION_MODE_CHANGED':
							if (isControlVideoInput) {
								this.compositorTransIndex = TRANSITION_MODE.findIndex(item => item.name === value)
								this.checkFeedbacks('update_execute_gui')
								this.sendCommand(`UPDATEGUI`)
							}
							break

						case 'COMPOSITOR_COMPOSITION_MODIFIED':
							if (isControlVideoInput) {
								this.updateCompositionDataFromJson(atob(value))

								// update buttons
								this.checkFeedbacks('update_crosspoint_gui', 'update_execute_gui', 'update_assign_gui')
							}
							break

						case 'COMPOSITOR_VIDEOINPUTID_CHANGED':
							if (isControlVideoInput) {
								let crosspointInfo = value.split(':')
								let crosspoint = crosspointInfo[0]

								// check if this event match the selected crosspoint
								if (this.compositorSelectedCrosspointId == crosspoint) {

									// assign new id and update gui
									this.crosspointVideoInputId = crosspointInfo[1]
									this.checkFeedbacks('update_crosspoint_gui')
								}
							}
							break

						case 'MEDIAPLAYLIST_PLAYED':
							if (isControlVideoInput) {
								this.mediaPlaylistPaused = false;
								this.checkFeedbacks('update_execute_gui')
							}
							break

						case 'MEDIAPLAYLIST_PAUSED':
							if (isControlVideoInput) {
								this.mediaPlaylistPaused = true;
								this.checkFeedbacks('update_execute_gui')
							}
							break

						case 'MEDIAPLAYLIST_MEDIA_LOOP_CHANGED':
							if (isControlVideoInput) {
								this.mediaPlaylistLoopEnabled = (value === 'true');
								this.checkFeedbacks('update_execute_gui')
							}
							break

						case 'MIXCOMPOSITOR_TRANSITIONS_STATUS_CHANGED':
							if (isControlVideoInput) {
								let val = value.split(':')
								this.mixCompositorTakeMode = TAKE_MODE[val[0]]
								this.mixCompositorTransitionStatus = val[1];
								this.checkFeedbacks('update_execute_gui')
							}
							break;

						case 'MIXCOMPOSITOR_PROGRAM_CHANGED':
							if (isControlVideoInput) {
								this.mixCompositorProgram = value;
								this.checkFeedbacks('update_execute_gui')

								// check if the selected crosspoint is the program one
								if (this.mixCompositorSelectedCrosspointId == MIXCOMPOSITOR_PROGRAM_ID) {

									// assign new id and update gui
									this.crosspointVideoInputId = value
									this.checkFeedbacks('update_crosspoint_gui')
								}
							}
							break

						case 'MIXCOMPOSITOR_PREVIEW_CHANGED':
							if (isControlVideoInput) {
								this.mixCompositorPreview = value;
								this.checkFeedbacks('update_execute_gui')

								// check if the selected crosspoint is the program one
								if (this.mixCompositorSelectedCrosspointId == MIXCOMPOSITOR_PREVIEW_ID) {

									// assign new id and update gui
									this.crosspointVideoInputId = value
									this.checkFeedbacks('update_crosspoint_gui')
								}
							}
							break

						case 'MIXCOMPOSITOR_TRANSITIONS_NAME_CHANGED':
							if (isControlVideoInput) {
								let index = value.indexOf(":")
								let takeMode = value.slice(0, index);
								let name = value.slice(index + 1);

								this.mixCompositorTransitionNames[takeMode] = name
								this.checkFeedbacks('update_execute_gui')
							}
							break;

						default:
							unhandledEvent = true
							break
					}
				}
				else if (dataStr.startsWith('SERVEREVENT')) {
					// filter server events
					return
				}
				else {
					unhandledEvent = true;
				}

				// unhandled? 
				if (unhandledEvent) {
					// log to console
					if (this.config.protocollog) this.log('debug', 'Network unhandled recv: ' + data)
				}
			})
	}

	/**
	 * Update MixBoard info 
	 */
	updateMixBoardInfo() {
		this.sendCommand(`MBC_GETMIXBOARDINFO ` + this.currentChannel, (data) => {
			var jsonData = atob(data.toString().trim())
			const jsonObj = JSON.parse(jsonData);

			let previewId = parseInt(jsonObj.PREVIEW.toString());
			let programId = parseInt(jsonObj.PROGRAM.toString());

			// update trans status
			this.transitionStatus = jsonObj.TRANSITION_STATUS

			// update status
			this.previewVideoInputId = previewId
			this.programVideoInputId = programId

			let keyers = jsonObj.KEYER
			keyers.forEach(keyerObj => {
				let kId = keyerObj.KEYERID
				let status = keyerObj.STATUS
				let link = keyerObj.LINK

				let kStatus = this.KEYER_STATUS.STOPPED
				if (status === "PLAY_TO_PREVIEW")
					kStatus = this.KEYER_STATUS.PLAY_TO_PREVIEW
				else if (status === "PLAY_TO_PROGRAM")
					kStatus = this.KEYER_STATUS.PLAY_TO_PROGRAM

				let keyer = this.getKeyer(kId)
				keyer.status = kStatus
				keyer.linkEnabled = link
			})

			this.checkFeedbacks();
		})
	}

	/**
	 * Set instance feedbacks
	 */
	initFeedbacks() {
		this.setFeedbackDefinitions({
			preview_videoinput: {
				type: 'boolean',
				name: 'VideoInput on Preview',
				description: 'The preview VideoInput has changed',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.videoinput_id)
					return this.previewVideoInputId == id
				},
			},

			program_videoinput: {
				type: 'boolean',
				name: 'VideoInput on Program',
				description: 'The program VideoInput has changed',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.videoinput_id)
					return this.programVideoInputId == id
				},
			},

			name_videoinput: {
				type: 'advanced',
				name: 'VideoInput name changed',
				description: 'The VideoInput name has changed',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					return {
						text: this.getVideoInput(feedback.options.videoinput_id).name || `IN ${feedback.options.videoinput_id}`
					};
				},
			},

			stopped_keyer: {
				type: 'boolean',
				name: 'Keyer stopped',
				description: 'The Keyer has stopped',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
						min: 0,
						max: 4
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					const result = this.getKeyer(id).status == this.KEYER_STATUS.STOPPED
					return result
				},
			},

			preview_keyer: {
				type: 'boolean',
				name: 'Keyer on Preview',
				description: 'The Keyer has played to preview',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					const result = this.getKeyer(id).status == this.KEYER_STATUS.PLAY_TO_PREVIEW
					return result
				},
			},

			program_keyer: {
				type: 'boolean',
				name: 'Keyer on Program',
				description: 'The Keyer has played to Program',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					const result = this.getKeyer(id).status == this.KEYER_STATUS.PLAY_TO_PROGRAM
					return result
				},
			},

			link_keyer: {
				type: 'boolean',
				name: 'Key link',
				description: 'The Key link status has changed',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					return this.getKeyer(id).linkEnabled
				},
			},

			channel_changed: {
				type: 'boolean',
				name: 'Current channel',
				description: 'The current channel has changed',
				options: [
					{
						id: 'channel',
						type: 'dropdown',
						label: 'Channel',
						choices: this.CHANNEL_CHOICES,
						default: "CH_0",
					},
				],
				callback: (feedback) => {
					return feedback.options.channel == this.currentChannel
				},
			},

			takemode_changed: {
				type: 'boolean',
				name: 'Take mode changed',
				description: 'The current Take mode has changed',
				options: [
					{
						id: 'take_mode',
						type: 'dropdown',
						label: 'Take Mode',
						choices: this.TAKEMODE_CHOICES,
						default: "CUT",
					},
				],
				callback: (feedback) => {
					let currentTakeMode = this.takeMode[this.currentChannel] || 'CUT';
					return currentTakeMode == feedback.options.take_mode
				},
			},

			update_execute_gui: {
				type: 'advanced',
				name: 'Update execute buttons',
				description: 'Update the execute buttons state',
				options: [
					{
						id: 'execute_id',
						type: 'number',
						label: 'Execute ID',
						default: 0,
						min: 0,
						max: MAX_EXECUTE_BUTTON,
					},
				],
				callback: (feedback) => {
					let executeId = feedback.options.execute_id

					let text = ''
					let bg = COLOR_BLACK
					let icon = ''

					switch (this.getVideoInput(this.config.control_videoinput_id).type) {
						case INPUT_TYPE.COMPOSITOR:
							// layout buttons [0-MAX_COMPO_LAYOUT]
							if (executeId < MAX_COMPO_LAYOUT) {
								text = this.compositorLayoutNames[executeId]
								bg = this.compositorLayoutId == executeId ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == COMPO_SPEED_MODE_ID) {
								icon = ANIMATION_SPEED[this.compositorSpeedIndex].icon
								bg = COLOR_BLACK
							}
							else if (executeId == COMPO_TRANSITION_MODE_ID) {
								icon = TRANSITION_MODE[this.compositorTransIndex].icon
								bg = COLOR_BLACK
							}
							break

						case INPUT_TYPE.MEDIAPLAYLIST:
							if (executeId == MEDIAPLAYLIST_PREVMEDIA_ID) {
								icon = MEDIAPLAYLIST_PLAYPREV_ICON
								bg = COLOR_BLACK
							}
							else if (executeId == MEDIAPLAYLIST_REWIND_ID) {
								icon = MEDIAPLAYLIST_REWIND_ICON
								bg = COLOR_BLACK
							}
							else if (executeId == MEDIAPLAYLIST_PLAYMEDIA_ID) {
								icon = this.mediaPlaylistPaused ? MEDIAPLAYLIST_PLAY_ICON : MEDIAPLAYLIST_PAUSE_ICON
								bg = this.mediaPlaylistPaused ? COLOR_BLACK : COLOR_ORANGE
							}
							else if (executeId == MEDIAPLAYLIST_LOOPMEDIA_ID) {
								icon = this.mediaPlaylistLoopEnabled ? MEDIAPLAYLIST_LOOPON_ICON : MEDIAPLAYLIST_LOOPOFF_ICON
								bg = this.mediaPlaylistLoopEnabled ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == MEDIAPLAYLIST_NEXTMEDIA_ID) {
								icon = MEDIAPLAYLIST_PLAYNEXT_ICON
								bg = COLOR_BLACK
							}
							break

						case INPUT_TYPE.MIXCOMPOSITOR:
							const highlightButton = this.mixCompositorTransitionStatus != TRANSITION_STATUS.TRANSITION_FINISHED
							const tm = this.mixCompositorTakeMode

							if (executeId == MIXCOMPOSITOR_CUT_ID) {
								text = 'CUT'
								bg = COLOR_BLACK
							}
							if (executeId == MIXCOMPOSITOR_FADE_ID) {
								text = 'FADE'
								bg = (highlightButton && tm == TAKE_MODE.FADE) ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == MIXCOMPOSITOR_TR1_ID) {
								text = this.mixCompositorTransitionNames.TR1
								bg = (highlightButton && tm == TAKE_MODE.TR1) ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == MIXCOMPOSITOR_TR2_ID) {
								text = this.mixCompositorTransitionNames.TR2
								bg = (highlightButton && tm == TAKE_MODE.TR2) ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == MIXCOMPOSITOR_TR3_ID) {
								text = this.mixCompositorTransitionNames.TR3
								bg = (highlightButton && tm == TAKE_MODE.TR3) ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == MIXCOMPOSITOR_TR4_ID) {
								text = this.mixCompositorTransitionNames.TR4
								bg = (highlightButton && tm == TAKE_MODE.TR4) ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == MIXCOMPOSITOR_RESUMEBACKWARD_ID) {
								icon = MEDIAPLAYLIST_PLAYPREV_ICON
								bg = this.mixCompositorTransitionStatus === TRANSITION_STATUS.TRANSITION_PAUSED ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == MIXCOMPOSITOR_RESUMEFORWARD_ID) {
								icon = MEDIAPLAYLIST_PLAYNEXT_ICON
								bg = this.mixCompositorTransitionStatus === TRANSITION_STATUS.TRANSITION_PAUSED ? COLOR_ORANGE : COLOR_BLACK
							}
							break

						default:
							text = ''
							bg = COLOR_BLACK
							icon = ''
							break;
					}

					return {
						text: text,
						bgcolor: bg,
						png64: icon
					};
				},
			},

			update_assign_gui: {
				type: 'advanced',
				name: 'Update assign buttons',
				description: 'Update the assign buttons state',
				options: [
					{
						id: 'assign_id',
						type: 'number',
						label: 'Assign ID',
						default: 0,
						min: 0,
						max: MAX_ASSIGN_BUTTON,
					},
				],
				callback: (feedback) => {
					let text = ""
					let icon = ''
					let bg = COLOR_BLACK
					switch (this.getVideoInput(this.config.control_videoinput_id).type) {

						case INPUT_TYPE.COMPOSITOR: {
							let id = feedback.options.assign_id
							let selectedCrosspoint = this.compositorSelectedCrosspointId
							let visible = id < this.compositorCrosspoints.length
							let selected = selectedCrosspoint == id

							text = visible ? this.compositorCrosspoints[id].name : ''
							icon = visible ? (selected ? CROSSPOINT_SELECTED_ICONS[id] : CROSSPOINT_ICONS[id]) : ''
							bg = visible ? (selected ? COLOR_ORANGE : COLOR_BLACK) : COLOR_BLACK
							break
						}

						case INPUT_TYPE.MIXCOMPOSITOR: {
							let id = feedback.options.assign_id
							let selected = this.mixCompositorSelectedCrosspointId == id

							if (id == MIXCOMPOSITOR_PROGRAM_ID) {
								text = 'PGM'
								icon = selected ? MIXCOMPO_PROGRAM_SELECTED_ICON : MIXCOMPO_PROGRAM_ICON
								bg = selected ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (id == MIXCOMPOSITOR_PREVIEW_ID) {
								text = 'PVW'
								icon = selected ? MIXCOMPO_PREVIEW_SELECTED_ICON : MIXCOMPO_PREVIEW_ICON
								bg = selected ? COLOR_ORANGE : COLOR_BLACK
							}
							break
						}
					}

					return {
						text: text,
						png64: icon,
						bgcolor: bg
					};
				},
			},

			update_crosspoint_gui: {
				type: 'boolean',
				name: 'Update crosspoint buttons',
				description: 'Update the crosspoint VideoInput buttons',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					let result = false
					const id = parseInt(feedback.options.videoinput_id)

					let controlVideoInputId = this.config.control_videoinput_id
					switch (this.getVideoInput(controlVideoInputId).type) {

						case INPUT_TYPE.COMPOSITOR:
						case INPUT_TYPE.MIXCOMPOSITOR:
							result = this.crosspointVideoInputId == id
							break
					}
					return result
				},
			},

			highlight_videoinput_control: {
				type: 'boolean',
				name: 'Highlight VideoInput control',
				description: 'Highlight the PGM/PVW VideoInput button when controlled',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
						min: 0,
						max: MAX_ASSIGN_BUTTON,
					},
				],
				callback: (feedback) => {
					return this.config.control_videoinput_id == feedback.options.videoinput_id
				},
			},

			update_resume_button: {
				type: 'boolean',
				name: 'Update resume button',
				description: 'Update the resume button according to transition status of the current channel',
				options: [

				],
				callback: (feedback) => {
					return this.transitionStatus === TRANSITION_STATUS.TRANSITION_PAUSED
				},
			},
		})
	}

	initActions() {
		this.setActionDefinitions({
			channel_action: {
				name: 'Set current channel',
				description: 'Select the current output channel',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
				],
				callback: ({ options }) => {
					if (this.config.linkChannelSelection) {
						this.sendCommand(`MBC_SELECTCHANNEL CHANNEL="${options.channel}"`)
					}
					else {
						this.currentChannel = options.channel;
						this.updateMixBoardInfo()
					}
				},
			},

			keyer_action: {
				name: 'Toggle Keyer',
				description: 'Play/Stop the given keyer to program or preview following the "Play to preview" option',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Keyer',
						id: 'keyer_id',
						choices: this.KEYER_CHOICES,
						default: 1,
					},
					{
						type: 'checkbox',
						label: 'Play to preview',
						id: 'play_to_prev',
						default: false,
					},
				],
				callback: ({ options }) => {
					// channel
					let channel = options.channel ?? this.currentChannel

					// toggle
					if (this.getKeyer(options.keyer_id).status == this.KEYER_STATUS.STOPPED) {
						// respect the target
						let target = options.play_to_prev ? 'PREVIEW' : 'PROGRAM'
						this.sendCommand(`MBC_PLAYKEYER CHANNEL="${channel}",KEYERID="${options.keyer_id}",TARGET="${target}"`)
					}
					else {
						this.sendCommand(`MBC_STOPKEYER CHANNEL="${channel}",KEYERID="${options.keyer_id}"`)
					}
				},
			},

			keylink_tap_action: {
				name: 'Key link',
				description: 'Enable/disable the keyer transition link option',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Keyer',
						id: 'keyer_id',
						choices: this.KEYER_CHOICES,
						default: 1,
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					let link = !this.getKeyer(options.keyer_id).linkEnabled
					this.sendCommand(`MBC_SETLINKKEYERTOTRANSITION CHANNEL="${channel}",KEYERID="${options.keyer_id}",LINK=${link}`)
					this.sendCommand(`UPDATEGUI`)
				},
			},

			set_takemode_action: {
				name: 'Set take mode',
				description: 'Select the take mode to execute on AUTO take command',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Take Mode',
						id: 'take_mode',
						choices: this.TAKEMODE_CHOICES,
						default: 'CUT',
					},
				],
				callback: ({ options }) => {
					if (this.transitionStatus == TRANSITION_STATUS.TRANSITION_FINISHED) {
						let channel = options.channel ?? this.currentChannel
						this.takeMode[channel] = options.take_mode;
						this.checkFeedbacks('takemode_changed')
					}
				},
			},

			autotake_action: {
				name: 'Auto Take',
				description: 'Auto take transition following the current take mode',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					let takeMode = this.takeMode[channel] ?? 'CUT';
					const cmd = `MBC_TAKE CHANNEL="${channel}",TAKE_MODE="${takeMode}"`
					this.sendCommand(cmd)
				},
			},

			take_action: {
				name: 'Take',
				description: 'Take transition',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Take Mode',
						id: 'take_mode',
						choices: this.TAKEMODE_CHOICES,
						default: 'CUT',
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_TAKE CHANNEL="${channel}",TAKE_MODE="${options.take_mode}"`
					this.sendCommand(cmd)
				},
			},

			resume_action: {
				name: 'Resume transition',
				description: 'Resume the paused transition following the given direction',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'textinput',
						label: 'Play direction',
						id: 'play_direction',
						choices: [
							{ id: 'BACKWARD', label: 'Backward' },
							{ id: 'FORWARD', label: 'Forward' },
						],
						default: 'FORWARD',
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_RESUMETRANSITION CHANNEL="${channel}",PLAY_DIRECTION="${options.play_direction}"`
					this.sendCommand(cmd)
				},
			},

			set_preview_action: {
				name: 'Set Preview VideoInput',
				description: 'Set the VideoInput to display to preview',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'number',
						label: 'VideoInput ID',
						id: 'videoinput_id',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_SETPREVIEWVIDEOINPUTID CHANNEL="${channel}",VIDEOINPUTID="${options.videoinput_id}"`
					this.sendCommand(cmd)
					this.sendCommand(`UPDATEGUI`)
				},
			},

			set_program_action: {
				name: 'Set Program VideoInput',
				description: 'Set the VideoInput to display to program',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'number',
						label: 'VideoInput ID',
						id: 'videoinput_id',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_SETPROGRAMVIDEOINPUTID CHANNEL="${channel}",VIDEOINPUTID="${options.videoinput_id}"`
					this.sendCommand(cmd)
					this.sendCommand(`UPDATEGUI`)
				},
			},

			set_tbar_value_action: {
				name: 'Set T-Bar value',
				description: 'Set the T-Bar from the internal variable "custom:tbar_value"',
				options: [
					{
						id: 'value',
						type: 'custom-variable',
						label: 'T-Bar value',
						useVariables: true
					},
				],
				callback: async ({ options }) => {

					let channel = options.channel ?? this.currentChannel

					// read variable
					const value = await this.parseVariablesInString('$(custom:' + options.value + ")")

					const cmd = `MBC_SETTBARVALUE CHANNEL="${channel}",TAKE_MODE="${this.takeMode[channel]}", VALUE="${value}"`
					this.sendCommand(cmd)
				},
			},

			command_action: {
				name: 'Execute command',
				description: 'Execute custom MBC command',
				options: [
					{
						id: 'command',
						type: 'textinput',
						label: 'Command'
					},
				],
				callback: ({ options }) => {
					const cmd = `${options.command}`
					this.sendCommand(cmd)
				},
			},

			control_program_input_action: {
				name: 'Control program VideoInput',
				description: 'Enable control of the program VideoInput',
				callback: () => {
					let videoInputToControl = this.programVideoInputId
					if (this.config.control_videoinput_id != videoInputToControl) {
						this.config.control_videoinput_id = videoInputToControl
						this.saveConfig()

						this.updateControlData(videoInputToControl)
						this.checkFeedbacks('highlight_videoinput_control')
					}
				},
			},

			control_preview_input_action: {
				name: 'Control preview VideoInput',
				description: 'Enable control of the preview VideoInput',
				callback: () => {
					let videoInputToControl = this.previewVideoInputId
					if (this.config.control_videoinput_id != videoInputToControl) {
						this.config.control_videoinput_id = videoInputToControl
						this.saveConfig()

						this.updateControlData(videoInputToControl)
						this.checkFeedbacks('highlight_videoinput_control')
					}
				},
			},

			control_execute_action: {
				name: 'Execute action',
				description: 'Generic execute action for control execute buttons',
				options: [
					{
						type: 'number',
						label: 'Execute ID',
						id: 'execute_id',
						default: 0,
						min: 0,
						max: MAX_EXECUTE_BUTTON
					}
				],
				callback: ({ options }) => {
					var executeId = options.execute_id
					var controlVideoInput = this.config.control_videoinput_id

					switch (this.getVideoInput(controlVideoInput).type) {
						case INPUT_TYPE.COMPOSITOR:
							// layout buttons [0-7]
							if (executeId < MAX_COMPO_LAYOUT) {

								this.compositorLayoutId = executeId
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="setActiveLayout ' + executeId + '"')
							}
							else if (executeId == COMPO_SPEED_MODE_ID) {

								this.compositorSpeedIndex = (this.compositorSpeedIndex + 1) % ANIMATION_SPEED.length
								let speed = ANIMATION_SPEED[this.compositorSpeedIndex].name
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="setAnimationSpeed ' + speed + '"')
							}
							else if (executeId == COMPO_TRANSITION_MODE_ID) {

								this.compositorTransIndex = (this.compositorTransIndex + 1) % TRANSITION_MODE.length
								let transitionMode = TRANSITION_MODE[this.compositorTransIndex].name
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="setTransitionMode ' + transitionMode + '"')
							}
							break

						case INPUT_TYPE.MEDIAPLAYLIST:
							if (executeId == MEDIAPLAYLIST_PREVMEDIA_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="gotoPreviousMedia"')
							}
							else if (executeId == MEDIAPLAYLIST_REWIND_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="rewindMedia"')
							}
							else if (executeId == MEDIAPLAYLIST_PLAYMEDIA_ID) {
								let cmd = this.mediaPlaylistPaused ? 'playMedia' : 'pauseMedia'
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="' + cmd + '"')
							}
							else if (executeId == MEDIAPLAYLIST_LOOPMEDIA_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="setLoopEnabled LOOP_ENABLED=' + !this.mediaPlaylistLoopEnabled + '"')
							}
							else if (executeId == MEDIAPLAYLIST_NEXTMEDIA_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="gotoNextMedia"')
							}

							break;

						case INPUT_TYPE.MIXCOMPOSITOR:
							if (executeId == MIXCOMPOSITOR_CUT_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="Take CUT"')
							}
							else if (executeId == MIXCOMPOSITOR_FADE_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="Take FADE"')
							}
							else if (executeId == MIXCOMPOSITOR_TR1_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="Take TR1"')
							}
							else if (executeId == MIXCOMPOSITOR_TR2_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="Take TR2"')
							}
							else if (executeId == MIXCOMPOSITOR_TR3_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="Take TR3"')
							}
							else if (executeId == MIXCOMPOSITOR_TR4_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="Take TR4"')
							}
							else if (executeId == MIXCOMPOSITOR_RESUMEBACKWARD_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="ResumeTransitionBackward"')
							}
							else if (executeId == MIXCOMPOSITOR_RESUMEFORWARD_ID) {
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="ResumeTransitionForward"')
							}
							break
					}
				},
			},

			control_assign_action: {
				name: 'Assign action',
				description: 'Generic assign action for control assign buttons',
				options: [
					{
						type: 'number',
						label: 'Assign ID',
						id: 'assign_id',
						default: 0,
						min: 0,
						max: MAX_ASSIGN_BUTTON
					}
				],
				callback: ({ options }) => {
					var controlVideoInput = this.config.control_videoinput_id

					switch (this.getVideoInput(controlVideoInput).type) {

						case INPUT_TYPE.COMPOSITOR:
							// select the crosspoint to be assigned from assign action
							this.compositorSelectedCrosspointId = options.assign_id
							this.updateControlData(controlVideoInput);
							break

						case INPUT_TYPE.MIXCOMPOSITOR:
							// select the crosspoint to be assigned from assign action
							this.mixCompositorSelectedCrosspointId = options.assign_id
							this.updateControlData(controlVideoInput);
							break
					}
				},
			},

			control_assign_crosspoint_action: {
				name: 'Assign crosspoint action',
				description: 'Assign the VideoInput to the selected crosspoint',
				options: [
					{
						type: 'number',
						label: 'VideoInput ID',
						id: 'videoinput_id',
						default: 0,
						min: 0,
						max: 24
					}
				],
				callback: ({ options }) => {
					var videoInputIdToControl = this.config.control_videoinput_id
					var videoInputIdToAssign = options.videoinput_id

					switch (this.getVideoInput(videoInputIdToControl).type) {

						case INPUT_TYPE.COMPOSITOR:
							if (this.compositorSelectedCrosspointId >= 0) {

								// update the current crosspoint videoinput id
								this.crosspointVideoInputId = videoInputIdToAssign

								this.sendCommand(`MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${videoInputIdToControl}", COMMAND="setCrossPointVideoInputId CROSSPOINTID=${this.compositorSelectedCrosspointId}, VIDEOINPUTID=${videoInputIdToAssign}"`)
								this.sendCommand(`UPDATEGUI`)
							}
							break

						case INPUT_TYPE.MIXCOMPOSITOR:
							if (this.mixCompositorSelectedCrosspointId >= 0) {

								let cmd = this.mixCompositorSelectedCrosspointId == MIXCOMPOSITOR_PROGRAM_ID ? 'SetSourceID' : 'SetNextSourceID'
								// update the current crosspoint videoinput id
								this.crosspointVideoInputId = videoInputIdToAssign

								let str = `MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${videoInputIdToControl}", COMMAND="${cmd} ID=${videoInputIdToAssign}"`
								this.sendCommand(`MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${videoInputIdToControl}", COMMAND="${cmd} ID=${videoInputIdToAssign}"`)
								this.sendCommand(`UPDATEGUI`)
							}
							break
					}
				},
			},
		})
	}

	/**
	 * Update the composition data from the given json string.
	 * NOTE: this method doesn't check any feedback, it just updates the internal data  
	 * 
	 * @param {*} jsonString 
	 */
	updateCompositionDataFromJson(jsonString) {
		const obj = JSON.parse(jsonString);

		this.maxVideoInput = parseInt(obj.MAX_SUPPORTED_INPUTS);

		// update current compo params
		this.compositorLayoutId = obj.ACTIVELAYOUT
		this.compositorLayoutNames = obj.LAYOUT_NAMES
		this.compositorSpeedIndex = ANIMATION_SPEED.findIndex(item => item.name === obj.ANIMATION_SPEED)
		this.compositorTransIndex = TRANSITION_MODE.findIndex(item => item.name === obj.TRANSITION_MODE)
		this.compositorCrosspoints = obj.CROSSPOINT_INFO.map(cp => ({
			id: cp.ID,
			name: cp.NAME
		}));

		this.crosspointVideoInputId = this.compositorCrosspoints?.[this.compositorSelectedCrosspointId]?.id ?? -1;
	}

	/**
	 * Update data of the controlling VideoInput
	 * 
	 *  @param {*} controlVideoInputId 
	 */
	updateControlData(controlVideoInputId) {
		switch (this.getVideoInput(controlVideoInputId).type) {

			case INPUT_TYPE.COMPOSITOR:
				this.sendCommand(`MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${controlVideoInputId}", COMMAND="getCompositorInfo"`, (data) => {
					var result = data.toString().trim()
					if (result != '') {
						// parse json
						var jsonData = atob(result)

						// read compo data from json and update 
						this.updateCompositionDataFromJson(jsonData)

						// always update gui
						this.checkFeedbacks('update_execute_gui', 'update_assign_gui', 'update_crosspoint_gui')
					}
				})
				break

			case INPUT_TYPE.MEDIAPLAYLIST:
				this.sendCommand(`MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${controlVideoInputId}", COMMAND="getMediaPlaylistInfo"`, (data) => {
					var result = data.toString().trim()
					if (result != '') {
						// parse json
						var jsonData = atob(result)
						const obj = JSON.parse(jsonData);

						// update data
						this.mediaPlaylistLoopEnabled = obj.IS_LOOP_ENABLED
						this.mediaPlaylistPaused = !obj.IS_MEDIA_PLAYING

						// always update gui
						this.checkFeedbacks('update_execute_gui', 'update_assign_gui', 'update_crosspoint_gui')
					}
				})
				break

			case INPUT_TYPE.MIXCOMPOSITOR:
				this.sendCommand(`MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${controlVideoInputId}", COMMAND="GetSwitcherInfo"`, (data) => {
					var result = data.toString().trim()
					if (result != '') {
						// parse json
						var jsonData = atob(result)
						const obj = JSON.parse(jsonData);

						// update data
						this.mixCompositorProgram = obj.PROGRAM
						this.mixCompositorPreview = obj.PREVIEW
						this.mixCompositorTransitionStatus = obj.TRANSITION_STATUS

						// read names 
						Object.keys(this.mixCompositorTransitionNames).forEach(key => {
							if (obj.TRANSITION_NAMES[key]) {
								this.mixCompositorTransitionNames[key] = obj.TRANSITION_NAMES[key];
							}
						});

						// update crosspoint VideoInput ID following the selected crosspoint (PGM/PVW)
						let selCrosspoint = this.mixCompositorSelectedCrosspointId
						if (selCrosspoint == MIXCOMPOSITOR_PROGRAM_ID) {
							this.crosspointVideoInputId = obj.PROGRAM
						}
						else if (selCrosspoint == MIXCOMPOSITOR_PREVIEW_ID) {
							this.crosspointVideoInputId = obj.PREVIEW
						}
						else {
							this.crosspointVideoInputId = -1
						}

						// always update gui
						this.checkFeedbacks('update_execute_gui', 'update_assign_gui', 'update_crosspoint_gui')
					}
				})
				break

			default:
				// update
				this.checkFeedbacks('update_execute_gui', 'update_assign_gui', 'update_crosspoint_gui')
				break;
		}
	}

	/**
	 * Send command to ClassX MixBoard instance
	 * @param {any} cmd command to execute
	 * @param {any} cb optional, data callback to execute in response to command
	 */
	sendCommand(cmd, cb) {
		if (cmd !== undefined && cmd != '') {
			if (this.socket) {// && this.socket.isConnected()) {

				// MANDATORY: always push a callback for any command if not supplied
				cb = cb ?? ((data) => { })

				this.dataCallback.push(cb)
				this.socket.send(cmd + '\r\n')
			}
		}
	}

	// Return config fields for web config
	getConfigFields() {
		return [
			{
				type: 'static-text',
				id: 'important-line',
				width: 12,
				label: 'Information',
				value: 'This module will establish a connection to ClassX MixBoard.',
			},
			{
				type: 'textinput',
				id: 'host',
				label: "MixBoard's IP",
				width: 12,
				regex: this.REGEX_IP,
			},
			{
				type: 'textinput',
				id: 'port',
				label: "MixBoard's command port",
				width: 6,
				regex: this.REGEX_PORT,
			},
			{
				type: 'textinput',
				id: 'eventport',
				label: "MixBoard's event port",
				width: 6,
				regex: this.REGEX_PORT,
			},
			{
				type: 'checkbox',
				id: 'linkChannelSelection',
				label: 'Link channel selection',
				width: 12,
			},
			{
				type: 'checkbox',
				id: 'protocollog',
				label: 'Protocol log to console',
				width: 12,
			},
		]
	}
}

runEntrypoint(MixBoardInstance)