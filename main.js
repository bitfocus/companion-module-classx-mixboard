const { InstanceBase, TCPHelper, Regex, runEntrypoint, InstanceStatus } = require('@companion-module/base')

// Base64 compatibility
const atob = (data) => Buffer.from(data, 'base64').toString('ascii')
const btoa = (data) => Buffer.from(data).toString('base64')
const rgb = (r, g, b) => (r << 16) + (g << 8) + b

// def
const MAX_EXECUTE_BUTTON = 10
const MAX_ASSIGN_BUTTON = 16
const MAX_COMPO_LAYOUT = 8
const COMPO_SPEED_MODE_ID = 8
const COMPO_TRANSITION_MODE_ID = 9

// button color define
const COLOR_ORANGE = rgb(177, 98, 19)
const COLOR_GREEN = rgb(50, 216, 17)
const COLOR_WHITE = rgb(255, 255, 255)
const COLOR_BLACK = rgb(0, 0, 0)
const COLOR_RED = rgb(207, 0, 0)

// coming from ColorPalette.java
const CROSSPOINT_COLORS = [
	rgb(220, 8, 8), // Red (#dc0808)
	rgb(0, 172, 232), // Cyan (#00ace8)
	rgb(255, 100, 4), // Orange (#ff6404)
	rgb(72, 0, 164), // Purple (#4800a4)
	rgb(252, 244, 4), // Bright Yellow (#fcf404)
	rgb(0, 0, 212), // Blue (#0000d4)
	rgb(32, 184, 20), // Bright Green (#20b814)
	rgb(192, 192, 192), // Silver (#c0c0c0)
	rgb(240, 8, 132), // Pink (#f00884)
	rgb(0, 100, 16), // Dark Green (#006410)
	rgb(88, 44, 4), // Dark Brown (#582c04)
	rgb(64, 64, 64), // Dark Gray (#404040)
	rgb(144, 112, 56), // Brownish Yellow (#907038)
	rgb(128, 128, 128), // Gray (#808080)
	rgb(0, 0, 0), // Black (#000000)
	rgb(255, 255, 255), // White (#ffffff)
];

// list of crosspoint colored icons 
const CROSSPOINT_ICONS = [
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QqREAMQzF0MD0X9/2sgddIcVUnnkGgn9de985t/4hTgMONeBQAw6t976XcwhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxECI81QZZR5t8o8EAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAzElEQVR4Xu3IsQ0AIQDDQPafhcHY4oHalZ/WkS6Fx5jrywOEOAhxEOIgxDm7l/8Q4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iBE2KEtX9Yt5BTNAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QsRGAMAzF0BSMyv4rBGhRpbiV754LlX/t+9o5t/4hTgMONeBQAw6t976XcwhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxECI8ETwZhjs7qTkAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0UlEQVR4Xu3QuRHAMAzEQJbnQt2nn1SIIKXgzDJAeHPN/WTfrCFOAx5qwEMNeGi++1/2IcRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiPAC+ehZRxkg59EAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0klEQVR4Xu3QKQ7AQAzF0AG9/2kLK3WhNfKEOtILMPzrOo87+9Y/xGnAoQYcasCh9d73sg8hDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkKEB9mm9dZ/AC4sAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAyUlEQVR4Xu3IoRHAQACEwOu/vvSTn9coEotYBNueN39gxMGIgxEHI852k+8w4mDEwYiDEQcjDkYcjDgYcTDiYMTBiIMRByMORhyMOBhxMOJgxMGIgxEHIw5GHIw4GHEw4mDEwYiDEQcjDkYcjDgYcTDiYMTBiIMRByMORhyMOBhxMOJgxMGIgxEHIw5GHIw4GHEw4mDEwYiDEQcjDkYcjDgYcTDiYMTBiIMRByMORhyMOBhxMOJgxMGIgxEHIw5GHIw4GHEw4mBEOCvVM8dErjVTAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA1ElEQVR4Xu3QuRGAQAzF0C2CAui/ArrjSFGkdSrPPAcK/zqv486+9Q9xGnCoAYcacGi9973sQ4iDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEOEBnHdZR3rM66QAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAz0lEQVR4Xu3IuREAMQzDQPVflTu7JxUiOAZnlgHmnPPk3uwQZ3aIMzvEmR3izLf/cg8hDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkKEFxDwbKXez2bfAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA0klEQVR4Xu3QqRHAQAzF0IUpPAWngxw0QlpTeeYZCP51Heedfesf4jTgUAMONeDQeu972YcQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByHCA6H4OlZMNQnrAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAzElEQVR4Xu3IsQ0AIQDDQEZgSPZf4YHalZ/WkS6Fx1jzywOEOAhxEOIgxDm7l/8Q4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iBE2BPYnbi6qN1rAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA00lEQVR4Xu3QqRHAQAzF0AUpJwWl/0Zy0AhpTeWZZyD413Ued/atf4jTgEMNONSAQ+u972UfQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyECA8/mrz4xzRLmAAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAz0lEQVR4Xu3IuREAMQzDQJXm/pu6JxUiOAZnlgHmnPPk3uwQZ3aIMzvEmR3izLf/cg8hDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkKEF+eiFIcGJxmYAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAA00lEQVR4Xu3QuRGAQAzF0C2LsiiFjjlSFGmdyjPPgcK/rvO4s2/9Q5wGHGrAoQYcWu99L/sQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iBEeADOENAHYSEuDAAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAzklEQVR4Xu3IuREAMQzDQJXuzu9JhQiOwZllgDnnPLk3O8SZHeLMDnFmhzjz7b/cQ4iDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEOEFfElAlh/OgSEAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAvElEQVR4Xu3IoREAMBDDsOy/9HcAI1+pgYi27fIFEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEQcRBxEHEeEBUwroaS1vcnIAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAzklEQVR4Xu3QIQ7AQAzEwPz/09cerZEb6pUmwDBz2mrzDc2tBy7XA5frgcvNu3vyH0IchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchDgIcRDiIMRBiIMQByEOQhyEOAhxEOIgxEGIgxAHIQ5CHIQ4CHEQ4iDEQYiDEAchDkIchAgPAz+UBPMH7wAAAAAASUVORK5CYII=',
];

// list of selected crosspoint colored icons 
const CROSSPOINT_SELECTED_ICONS = [
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABxUlEQVR4Xu3Q74dUcRzF8XPnzp25M/fOnZm7/bD9/l2rtau1Wq1Wa7NZbWWz2Wy/ExGRiCURkYhIREQiItFf1P9yqqd9H33PPD0fXp8H74cHv/OcpsP/weJ4wBF5wBF5wBHh7/17pguCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxUgT0HTI0oSmQ54lNB2KVkLTocoTmg6DToOmw1jRoOmwo2zQdBivUpoOe/opTYd9w5Smw8G6SdPhyLYmTYfj25s0HSZ2Nmk6TI5nNB2md2U0HWZ2ZzQdZve2aDrM7W/RdJg/0KLpsHCoTdNh8XCbpsPS0TZNh+VjbZoOKydymg6rEzlNh8snc5oOa5Mdmg7rUx2aDhvTHZoOm6e6NB1uznRpOtyZ7dJ0uH+6S9PhwVxB0+HhmYKmw6P5gqbD47MlTYcnCyVNh6fnSpoOzxZLmg5bSz2aDs/P92g6vFju0XR4eaGi6fBqpaLp8PpiRdPhzWqfpsPbS32aDu+u9Gk6vF/r03T4cHVA0+Hj+oCmw6drA5oOnzeGNB2+XB/SdPi6OaTp8O1GTdPh+62apsOP2zVNh593a5oOv+6N0XR/AF/CpXwMxV6zAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABwElEQVR4Xu3I7YcVcQDF8TN37tw7987cmXtne7A9P9dqtVqr1Wq1NpvVbtlsNttzIiISEYmIREQiIhIRKf1d/Renev179Tu9PYfPefEFfv6m/YcgWJwgWJwgWJwgWJy/+3emC4LFCYLFCYLFCYLFCYLFCYLFCYLFCYLFCYLFCYLFCYLFSBPQdMjShKZDniU0HYpOQtOhyhOaDsNei6bDWNGi6bCtbNF0GK9Smg676pSmw55RStNhf9Om6XBoS5umw9GtbZoOE9vbNB0mxzOaDlM7MpoO0zszmg4zuzs0HWb3dmg6zO3r0HSYP9Cl6bBwsEvTYfFwl6bD0pEuTYflYzlNh5WJnKbDxeM5TYe1yR5Nh/UTPZoOG1M9mg6bJ/s0Ha5P92k63Jrp03S4e6pP0+HebEHT4f7pgqbDg7mCpsPDMyVNh0fzJU2Hx2dLmg5PFkqaDk8XBzQdnp0b0HR4vjSg6fDifEXT4eVyRdPh1YWKpsPrlZqmw5vVmqbD20s1TYd3azVNh/eXhzQdPqwPaTp8vDKk6fBpY0TT4fPVEU2HL5sjmg5frzU0Hb7daGg6fL/Z0HT4cbuh6fDrzhhN9wcr6awLkD8HswAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABwklEQVR4Xu3Q74dUcRzF8XPn3pm5M3fm3pm7/bD9/l2rtau1Wq1Wa7NZbWWz2Wy/UyIisUQiIhGRiIhERKJ/8VRP+z76nnl6Prw+D94PD/gwo+nwf7A4HnBEHnBEHnBE+Hv/numCYHGCYHGCYHGCYHGCYHGCYHGCYHGCYHGCYHGCYHGCYDHSBDQdmmlC0yFvJjQdilZC06HME5oOg06DpsNY0aDpsKPXoOkwXqY0HfZUKU2HfcOUpsPBOqPpcGRbRtPh+PaMpsPEzoymw+R4k6bD9K4mTYeZ3U2aDrN7WzQd5va3aDrMH2jRdFg41KbpsHi4TdNh6WibpsPysTZNh5UTOU2H1YmcpsPlkzlNh7XJDk2H9akOTYeN6Q5Nh81TXZoON2e6NB3uzHZpOtw/3aXp8GCuoOnw6ExB0+HxfEHT4cnZHk2Hpws9mg7PzvVoOmwt9mg6PF/q03R4cb5P0+Hlcp+mw6sLJU2H1yslTYc3F0uaDm9XK5oO7y5VNB3eX6loOnxYq2g6fLw6oOnwaX1A0+HztQFNhy8bQ5oOX68PaTp82xzSdPh+o6bp8ONWTdPh5+2apsOvuzVNh9/3xmi6P5vpZbu8ww2gAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABwklEQVR4Xu3Q74dUcRzF8XPnzp25M/fOvTOz/bD9/l2r1WqtVqvV2mxGW9lsNtvvREQkIhIRiYhERCRKJPoXT/W076Pvmafnw+vz4P3wYITvNB3+DxbHA47JA47JA44Jf+/fM10QLE4QLE4QLE4QLE4QLE4QLE4QLE4QLE4QLE4QLE4QLEaagKZDliY0HfIsoelQtBKaDlWe0HTodxo0HSaKBk2HbWWDpsNkldJ02FWnNB32DFKaDvuHTZoOh7Y0aToc3dqk6TC1vUnTYXoyo+kwsyOj6TC7M6PpMLe7RdNhfm+LpsPCvhZNh8UDbZoOSwfbNB2WD7dpOqwcadN0GB3LaTqsTuU0HS4dz2k6rE13aDqsn+jQdNiY6dB02DzZpelwY7ZL0+H2XJemw71TXZoO9+cLmg4PThc0HR4uFDQdHp0paTo8XixpOjw5W9J0eLpU0nR4ttyj6fD8XI+mw4uVHk2Hl+crmg6vRhVNh9cXKpoOb1Zrmg5vL9Y0Hd5drmk6vF+raTp8uNKn6fBxvU/T4dPVPk2HzxsDmg5frg1oOnzdHNB0+HZ9SNPhx80hTYeft4Y0HX7dGdJ0+H13gqb7A4SkpXzO3BKfAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABw0lEQVR4Xu3Q3YdVcRjF8bXP3vucfc7e521PL6b39xqNRmM0Go3GZDKaKZPJZHpPREQiIhGRiEhERCIi0V/XZazqtt/Vb53b9fB5Lr6XC79/ZTQd/g8WxwOOyAOOyAOOCH/v3zNdECxOECxOECxOECxOECxOECxOECxOECxOECxOECxOECxGmoCmQ54mNB2KPKHpUDYTmg69IqHpMGg3aDqMlQ2aDtuqBk2H8V5K02FXP6XpsGeY0nTYX2c0HQ5tyWg6HN2a0XSY2J7RdJgcz2k6TO3IaTpM78xpOszsbtJ0mN3bpOkwt69J02H+QIumw8LBFk2HxcMtmg5LR1o0HZaPFTQdViYKmg4Xjxc0HdYm2zQd1k+0aTpsTLVpOmye7NB0uD7doelwa6ZD0+HuqQ5Nh3uzJU2H+6dLmg4P5kqaDg/PVDQdHs1XNB0en61oOjxZqGg6PF3s0nR4dq5L0+H5Upemw4vzPZoOL5d7NB1eXejRdHi90qfp8Ga1T9Ph7aU+TYd3a32aDu8vD2g6fFgf0HT4eGVA0+HTxpCmw+erQ5oOXzaHNB2+XqtpOny7UdN0+H6zpunw43ZN0+HnnTGa7g9kYkIaPVRADAAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABv0lEQVR4Xu3I72dVcQDH8c+55557z73n3HPuPeuH9bvWr2maZpqmaZZl2sqyWdbvREQkIhIRiYhERCQiEv01/T+f9Pj76Pvp6efB6/3gDeAP7X8Ew+IEw+IEw+IEw+IA/2K6YFicYFicYFicYFicYFicYFicYFicYFicYFicYFicYFiMNAFNhyxNaDrkWULToegkNB2qPKHpMOy1aDqMFS2aDrvKFk2H8Sql6bCvTmk6HBilNB0ON22aDkd3tGk6nNjZpukwubtN02FqPKPpML0no+kwszej6TC7v0PTYe5gh6bD/KEOTYeFI12aDosTXZoOS8e6NB2Wj3dpOqyczGk6rE7mNB2unMppOqxP9Wg6bJzu0XTYmu7RdNg+06fpcHOmT9PhzmyfpsP9s32aDg/mCpoOD88VNB0ezRc0HR6fL2k6PFkoaTo8vVDSdHi2WNJ0eL40oOnw4uKApsPL5QFNh1eXKpoOr1cqmg5vLlc0Hd6u1jQd3q3VNB3eX61pOnxYr2k6fLw2pOnwaWNI0+Hz5pCmw5etEU2Hr9dHNB2+bY9oOny/0dB0+HGroenw83ZD0+HX3Yamw+97YzTdX7aCf/xEyh/eAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABxElEQVR4Xu3Q34dUcRzG8efMmTNzZs6ZMzNnt7L93H63Wq3WarVarc1mtZXNZrP9TkREIiIRkYhIREQiItF1/91T3fa9+j5z+3x4fS7elw8mf4/TdPg/WBwPOCIPOCIPOCL8vX/PdEGwOEGwOEGwOEGwOEGwOEGwOEGwOEGwOEGwOEGwOEGwGGkCmg5ZmtB0yLOEpkPRSmg6VHlC02HQadB0GCsaNB22lw2aDhNVStNhdz+l6bB3mNJ02F83aTocGm/SdDi6rUnTYWpHk6bD9ERG02FmZ0bTYXZXRtNhbk+LpsP8vhZNh4XJFk2HxQNtmg5LB9s0HZYPt2k6rBxp03RYPZbTdFibymk6XDqe03RYn+7QdNg40aHpsDnToemwdbJL0+HGbJemw+25Lk2He6e6NB3uzxc0HR6cLmg6PFwoaDo8OlPSdHi8WNJ0eHK2pOnwdKmk6fBsuUfT4fm5Hk2HFys9mg4vz1c0HV6tVjQdXl+oaDq8WevTdHh7sU/T4d3lPk2H9+t9mg4frgxoOnzcGNB0+HR1QNPh8+aQpsOXa0OaDl+3hjQdvl2vaTp8v1nTdPhxq6bp8PNOTdPh190xmu4PJzOlfPgIsgMAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABwklEQVR4Xu3Ia4dVYQDF8bXPPvvc9j57n7Oni+l+r9FoNEaj0WhMJqOpTCaT6Z6IiEREIiIRkYiIRESiz3C+2arenufVs16vxW+9+GM0GtF0GA8WB+PB4mA8WByMB4uDf/t/pguCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxQmCxUgT0HTI0oSmQydLaDrkrYSmQ9lJaDoMug2aDhN5g6bDjqJB02GyTGk67KlSmg77hilNh4N1k6bDkW1Nmg7HtzdpOkztbNJ0mJ7MaDrM7MpoOszuzmg6zO1t0XSY39+i6bBwoEXTYfFQm6bD0uE2TYflo22aDivH2jQdVk90aDqsTXVoOlw52aHpsD7dpemwcapL02FzpkvTYet0j6bDrdkeTYe7cz2aDg/O9Gg6PJzPaTo8OpvTdHi8kNN0eHKuoOnwdLGg6fDsfEHT4flSQdPhxXKfpsPLC32aDq9W+jQdXl8saTq8WS1pOry9VNJ0eLdW0XR4f7mi6fDhakXT4eN6RdPh07UBTYfPGwOaDl+uD2g6fN0c0nT4dmNI0+H71pCmw4+bNU2Hn7drmg6/7tQ0HX7fq2k6/Lk/QdP9BZuduNpDhNgVAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABxUlEQVR4Xu3Q74dUcRzF8XPnzp25M3Pn3pm7/bD9/l2r1WqtVqvV2mxWu2Wz2Wy/ExGRiEhESkQkIiIRkehv6z841dO+j75nnp4Pr8+D98OD3/krmg7/B4vjAUfkAUfkAUeEv/fvmS4IFicIFicIFicIFicIFicIFicIFicIFicIFicIFicIFiNNQNMhSxOaDnmW0HTotRKaDmWe0HQYdBo0HcZ6DZoO24oGTYfxMqXpsKtKaTrsGaY0HfbXTZoOh7Y0aToc3dqk6TCxvUnTYXI8o+kwtSOj6TC9M6PpMLO7RdNhdm+LpsPcvhZNh/kDbZoOCwfbNB0WD7dpOiwdadN0WD6W03RYmchpOlw8ntN0WJvs0HRYP9Gh6bAx1aHpsHmyS9Ph+nSXpsOtmS5Nh7unujQd7s32aDrcP92j6fBgrkfT4eGZgqbDo/mCpsPjswVNhycLBU2Hp4t9mg7PzvVpOjxf6tN0eHG+pOnwcrmk6fD6QknT4c1KRdPh7WpF0+HdpYqmw/u1iqbDh8sDmg4f1wc0HT5dGdB0+LwxpOnw5eqQpsPXzSFNh2/XapoO32/UNB1+3KxpOvy8XdN0+HVnjKb7Ayy0hou1u41GAAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABvklEQVR4Xu3I/2dVcQDG8efcc8+9595z7jn3nvXF+v69ptk00zRNsyzTKsuyrO8pEZEYkYhIRCQiIhGR6F98qp8/P32efn0eXs8Pb+DhkPYfgmBxgmBxgmBxgmBx/u7fmS4IFicIFicIFicIFicIFicIFicIFicIFicIFicIFicIFiNNQNMhSxOaDnmW0HQoOglNhypPaDoMey2aDmNFi6bDjrJF02G8Smk67KlTmg77RilNh4NNm6bDkW1tmg7Ht7dpOkzsbNN0mBzPaDpM78poOszszmg6zO7t0HSY29+h6TB/oEPTYeFQl6bD4uEuTYelo12aDsvHujQdVk7kNB1WJ3KaDpdP5jQd1iZ7NB3Wp3o0HTamezQdNk/1aTrcnOnTdLgz26fpcP90n6bDg7mCpsOjMwVNh8fzBU2HJ2dLmg5PF0qaDs/OlTQdthZLmg7PlwY0HV6cH9B0eLk8oOnw6kJF0+H1SkXT4c3FiqbD29WapsO7SzVNh/dXapoOH9Zqmg4frw5pOnxaH9J0+HxtSNPhy8aIpsPX6yOaDt82RzQdvt9oaDr8uNXQdPh5u6Hp8OtuQ9Ph970xmu4PnoXp7aR0pUYAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABwUlEQVR4Xu3Q64dVcRjF8bXP3vvc9jl7n7Oni+l+r9HRaIxGo9GYTEZTmUympnsiIhIRiYhERCIiEhGJ/sVVve336rfO2/XweV58Xy5cH2U0Hf4PFscDjskDjskDjgl/798zXRAsThAsThAsThAsThAsThAsThAsThAsThAsThAsThAsRpqApkOeJjQd2nlC06FoJjQdynZC02HQadB0mCgaNB229Ro0HSbLlKbDriql6bBnmNJ02F9nNB0ObcloOhzdmtF0mNqe0XQYTeY0HaZ35DQdZnbmNB1mdzdpOsztbdJ0mN/XpOmwcKBF02HxYIumw9LhFk2H5SMtmg4rx9o0HVan2jQdLh1v03RYG3VoOqyf6NB02Jju0HTYPNml6XBzpkvT4c5sl6bD/VNdmg4P5gqaDg9PFzQdHs0XNB0en+nRdHiy0KPp8PRsj6bDs8UeTYfnS32aDi/O9Wk6vFzu03R4db6k6fB6paTp8OZCSdPh7WpF0+HdxYqmw/vLFU2HD2sVTYePVwY0HT6tD2g6fL46oOnwZWNI0+HrtSFNh2+bQ5oO32/UNB1+3KppOvy8XdN0+HW3punw+94ETfcHykcJPGAmZDkAAAAASUVORK5CYII=',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABwElEQVR4Xu3I24dVcQDF8bXPPvvc9j77nLOni+nedB2NRmM0Go22yWQ0lcmMyXRPREQiIhGRiEhERCIi0b+4qtfze/qt57X4rIcv6rqm6TAeLA7Gg8XBeLA4GA8WB//2/0wXBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIuRJqDpkKUJTYdOltB0yFsJTYeyk9B0GHYbNB0m8gZNh11Fg6bDZJnSdNg3SGk6HBilNB0OV02aDkd3NGk6nNjZpOkwvbtJ02FmMqPpMLsno+kwtzej6TC/v0XTYeFgi6bD4qEWTYelqTZNh/pIm6bD8rE2TYeV422aDqsnOzQd1qY7NB2unurQdFif6dJ02DjdpemwNdul6bB9pkfT4dZcj6bD3fkeTYcHZ3s0HR4u5DQdHp3LaTo8XsxpOjw5X9B0eLpU0HR4dqGg6fC8Lmg6vFju03R4ebFP0+HVSp+mw+tLJU2HN6slTYe3l0uaDu/WBjQd3l8Z0HT4cG1A0+Hj+oCmw6frQ5oOnzeGNB2+bA5pOnzdGtF0+HZjRNPh+/aIpsOPmxVNh5+3K5oOv+5UNB1+36toOvy5P0HT/QVyXmC8RmMQXAAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABw0lEQVR4Xu3Q74dUcRzF8XPnzp25M3Pn3pm7/bD9/l2r1WqttlartdmstrLZbLbfiYioiEhEJCJWREQiItG/eKqnfR99zzw9H16fB++HB5tPT9N0+D9YHA84Ig84Ig84Ivy9f890QbA4QbA4QbA4QbA4QbA4QbA4QbA4QbA4QbA4QbA4QbAYaQKaDlma0HTIs4SmQ6+V0HQo84Smw6DToOkw1mvQdNhWNGg6jJcpTYddVUrTYc8wpemwv27SdDi0pUnT4ejWJk2Hie1Nmg6T4xlNh6kdGU2H6Z0ZTYeZ3S2aDrN7WzQd5va1aDrMH2jTdFg42KbpsHi4TdNh6UibpsPysZymw8pETtPh8vGcpsPqZIemw9qJDk2H9akOTYeNk12aDjenuzQd7sx0aTrcP9Wl6fBgtkfT4eGZHk2HR3M9mg6PzxY0HZ7MFzQdnp0raDo8XyhoOrxY7NN0eHm+T9Ph1VKfpsPrCyVNhzfLJU2HtxdLmg7vViqaDu8vVTQdPlypaDpsrlY0HT5eHdB0+LQ2oOnw+dqApsOX9SFNh6/XhzQdvm0MaTp8v1HTdPhxq6bp8PN2TdPh192apsPve2M03R9YzBxL49RmlQAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABwElEQVR4Xu3I24dVcQDF8bXPPvvc9j57n7Oni+l+r9FoNEaj0WhMJqOpTCaT6Z6IiEREoiMSEYmISEQk+hdX9Xp+T7/1vBaf9fDFaDSi6TAeLA7Gg8XBeLA4GA8WB//2/0wXBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIsTBIuRJqDpkKUJTYdOltB0yFsJTYeyk9B0GHQbNB0m8gZNhx1Fg6bDZJnSdNhTpTQd9g1Tmg4H6yZNhyPbmjQdjm9v0nSY2tmk6TA9mdF0mNmV0XSY3Z3RdJjb26LpML+/RdNh4UCLpsPioTZNh6XDbZoOy0fbNB1WjrVpOqye6NB0WJvq0HS4crJD02F9ukvTYeNUl6bD5kyXpsPW6R5Nh1uzPZoOd+d6NB0enOnRdHg4n9N0eHQ2p+nweCGn6fDkXEHT4eliQdPh2fmCpsPzpYKmw4vlPk2Hlxf6NB1erfRpOry+WNJ0eLNa0nR4e6mk6fBuraLp8P5yRdPhw9WKpsPH9Yqmw6drA5oOnzcGNB2+XB/QdPi6OaTp8O3GkKbD960hTYcfN2uaDj9v1zQdft2paTr8vlfTdPhzf4Km+wsHBYzLdaDm3AAAAABJRU5ErkJggg==',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABuUlEQVR4Xu3I7WdVcQAH8O+55557z73n3HPuPevBen5cTbNppmmaZlmmrSzLsmo9iIhIRExEJCISEZGISPQvfvsDfq9+395+X3zefACA9l+CsDhBWJwgLE4QFicIixOExQnC4gRhcYKwOEFYnCAsThAWJwiLE4TFCcLiBGEx0gQ0HbI0oemQZwlNh6KT0HSo8oSmw7DXoukwVrRoOuwrWzQdxquUpsOhOqXpcGSU0nQ43rRpOpza06bpcGZvm6bD5P42TYep8Yymw8yBjKbD7MGMpsPc4Q5Nh/mjHZoOC8c6NB0WT3RpOiyd7NJ0WD7dpemwMtGl6bB6NqfpsDaZ03S4fi6n6bAx1aPpsDndo+mwNdOj6bB9vk/T4e5sn6bD/bk+TYdHF/o0HR7PFzQdnlwsaDo8XShoOjy7VNJ0eL5Y0nR4cbmk6fByqaTp8Gp5QNNh98qApsPrlQFNhzdXK5oOb1crmg7vrlU0Hd6v1TQdPqzXNB0+3qhpOnzaqGk6fL45pOnwZXNI0+HrrSFNh29bI5oO32+PaDr82B7RdPh5p6Hp8OteQ9Ph905D0+HPg4amw9+HYzTdP923NK0wkAl0AAAAAElFTkSuQmCC',
	'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABw0lEQVR4Xu3Q74dUcRzF8XPnzp25M/fO3Jm7/bD9bvu5Wq3WarVarc1mtVt2bTbb70REJCISEYmIREQkIhL9i6d62vfR98zTc3h9HrwffkBvpOH/4MXNDxxxfuCI8wNHHP7u3zFdECxOECxOECxOECxOECxOECxOECxOECxOECxOECxOECxGmoCmQ5YmNB3yLKHpULQSmg79PKHpMOg0aDqMFQ2aDrvKBk2H8X5K02FfldJ0ODBMaTocrps0HY7uaNJ0OLGzSdNhcneTpsPUeEbTYXpPRtNhZm9G02F2f4umw9zBFk2H+UMtmg4LE22aDotH2jQdlo61aTosH2/TdFg5mdN0WJ3MaTpcOZXTdFif6tB02DzdoemwNd2h6bB9pkvT4eZMl6bDndkuTYf7Z7s0HR7MFTQdHp4raDo8mi9oOjw+X9J0eLJQ0nR4eqGk6fBssaTp8HypR9PhxcUeTYeXyz2aDq8u9Wk6vF7p03R4c7lP0+HtakXT4d1aRdPh/dWKpsOH9Yqmw8eNAU2HT5sDmg6frw1oOnzZGtJ0+Hp9SNPh2/aQpsP3GzVNhx+3apoOP2/XNB1+3a1pOvy+N0bT/QGN7OA5H51EvgAAAABJRU5ErkJggg==',
]

// icons
const OVERLAY_PROGRAM_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAB3RJTUUH6QgbDxIbszqFtwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAW1JREFUeNrt3FFqwlAQheFaxyRYpF2Bq3AZ2VeX6EZMoohaL3QF+R+Ggf+DvB8Od5wENZvtdvv7odXibc4OUVl0XTdlh6gsdrudBQLtBDrCgCMMtRH2BAKeQMgCIZcI1G6kPYFA9H3vCQTifXkCgc0wDNkZJK22+b+00md2gOosELJAyAKhOJ1O2RlKi3Ec3cKAIwxZIGSBUDyfz+wMpcX5fHaJAI4wZIGQBUIWCMWyLNkZSovL5eIWBhxhyAIhC4QsEIrj8ZidobQYhsEtDDjCkAVCFgjF9XrNzlBaexZ2iQCOMGSBkAVCFgjFPPsjfaJ9L+wWBhxhyAIhC4Riv99nZygtDoeDSwRwhCELhCwQskDIRzkoXq+XWxhwhCELhCwQisfjkZ2htLjf7y4RwBGG2puLuuwQlbUb6Z/sEJW1Ar+zQ1QW0zR5AoFWoCcQ8DMQan+0sUDAJQLF7Xb7yg5RWXsBo49ygI9ykAVCf1tYSlOzfrIjAAAAAElFTkSuQmCC'
const KEYLINK_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEp2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI1LTA2LTE4PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmMyNDA0MDcyLTg0NjEtNDZmMC1hOGE1LWJjZDgwMDJmODA1MDwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6ZGM9J2h0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvJz4KICA8ZGM6dGl0bGU+CiAgIDxyZGY6QWx0PgogICAgPHJkZjpsaSB4bWw6bGFuZz0neC1kZWZhdWx0Jz5UaXRvbG8gLSAxPC9yZGY6bGk+CiAgIDwvcmRmOkFsdD4KICA8L2RjOnRpdGxlPgogPC9yZGY6RGVzY3JpcHRpb24+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJv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'
const HIGHLIGHT_CONTROL_VIDEOINPUT_ICON = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAABT0lEQVR4Xu3cPU5CURRF4e0/Wr3EWjChwFBgkNBhfAkNFBhiQmuoKB0DA3CijkJDe151zq5M1km+Zperu83Vz/fkF3WKA3IIaCKgiYAmDQaDD9RpOByuUKfxePyKOk0mkxfUaTabPaFO8/n8AXVaLpf3qFPbtj3UieO4/35nsHQG5HQG5HQG5HQG5HQGZByPx3PUKQ7IURyQozggR3FAjna73QXqCGgioImAJgKaCGhS27aXqFMckKM4IEdxQI7igBzFATk6HA5XqCOgiYAmApoIaDq9ha9RR0ATAU0ENBHQRECT1uv1DeoIaCKgiYAmApq03+97qFMckKM4IEdxQI7igBzFATmnt/At6ghoIqCJgCYCmrTZbO5QR0CTttttgzqtVqtH1GmxWDyjTtPp9A11Go1G76hTv9//RJ2apvlCHd8gmwhoIqCJgCYCmv4A+p4mBoDK2XgAAAAASUVORK5CYII='
const COMPO_EASING_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAADBElEQVR4Xu2by2tTQRSHv8Qa0loRpDVSX7FEUBERdWsrUhERJJtiIerGgiAF/wM34kJcuXDhwoUrlyLoQtzY+kQsLtRuNFItaBXfxDa1TeqiRs490SaCd+ZmnI9ZnNzfuQk/5szcx2TA4/F4PB6PLWL6QJRJwHrohDSkoA1aoAWSkAQgDnHYoc+TRN5wE3TBPuiCzZDQ+m+IvKc/sBJOwVuY/cvWeCyBMzBZ5aTONi/R6/5uuAhr9GGAWRiDERiFN/AOCjABE1AEoAxluK3PizD9MF3VYx/hAmRhqU5vcI5XWX0J/dCsE52gD8rCaglOVy42DpKBr8JtAfbrFIeIwR3htgg9OsUtcsFx2691t2iCUeH2stado0+4nYS1WneOu8LwOS06R0ZcikqwTuthENcHTJITt7aD8CyoOsiwqOcjWnSODlHPM9Cm9ZCwV9K7RT0/gPdBNTTsGd4p4usidpa8GMDSvJu0C7dFo09Flkp6u4gfV95XGMGS4W0ifiji8LFkWPbwsIidZUyM4S1adA45Y03CQq2Hio2S3iTiEZgWH8PHtuEnIjaCN2wAq4aNE4MvYtJapXXnWC3cfrKwtmW8pGU9P4Vai33/HKuGbQxgbzhsbBs2SwKKYtIy9R7LHluF21daNIPZkrb3GPwLs4Yj8Bhsz7ClHjZIM0z9VzPWLuHW3jKSwZLuFvGQiM1i0PAeEd8UsZukoFSp5xIs17oxTPVwVvzUMIwHVYOYMpwT8RURu8kGsRRchk6tO8d5cUG6pUXnyATvN3q17hYxuCrc5mGBTnGLY8LtLBzQulvshe/C7aCFd5QG6Q1uWvgMaZ3iCovgbPDf3jOQ1VlOsBgG4HVw3JbhqE5scFbAQbgU/Ff7XJuCQzrdLrWmkR6Y298GJCtb31qhHTogDRthmT7pJ8/hMNzTh6ON6rE6WwFOQqv+skag2sz8bQxOQEp/TXSoVdL1LHZ9g0cwBNfgPpS1HilqGb5R2d8GFKFY2fr2AcZhFF5AHkr6PI/H4/F4PJ4qfgAuVil/9zLO9QAAAABJRU5ErkJggg=='
const COMPO_CUT_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAABcklEQVR4Xu3bv0oDQRDH8a+JYtBaEQQbqzS+gZ2FaGml4BPY+h4+hi8QtLD1EWysrYKlGPwbrQKTOQ6Eu9uRye/DFsNsYO/H3rHNBkRERCTKkm8UswvnMIQN6EPPzze17xuhzuAdfroc/8gOvFaer/VRo/U36Q9OYc33ion4hm/hcFZfwQi+YDr/m+bufSPOg3nx9vxkRs8m8Kaf7FrENzww9cTUaX2YHV7xk12L2OG+qb9NXUREYHsy1B+YHYkIHCriHLa7Wnz9hdthBc5OgbNT4OwUODsFzk6Bs1Pg7BQ4OwXOToGzU+DsFDg7Bc5OgbNT4OwUODsFzk6Bs1Pg7IoHLn4xyyke2Cp+7zAicOhFy4jAoVdpIwKvmvrN1KUUD7xu6oUIvGXqsalLqT8lDnyjqR4swxFczDo3cDz/m0jV/3q1Pi79mqGqz9fueIFtv2ao6iO2OCZw4hcso/4bvvONpqbwCWN4hGt48vMiIiKS3S+zMchbh4IbKQAAAABJRU5ErkJggg=='
const COMPO_SLOW_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAAELUlEQVR4Xu3bzW4bVRiA4Xds0okbp2mdOFKx20Crqimpu4AFv0IIiVtAqN6xRCyQSlXSvygF1KJWBRZcAVLgMlCBK0iiAuqChCSCOEmTOD+e0HpYfDh1TmJ7ZnzGnrHmWc6ZSH79zdiJfQKRSCQSiUQikUhjMfXAfnH1QEjFDGw4dYzkIdYtdbVK+INjBsDpFO+d4lyavzdY2lLPqeLgIgismIEBp4/x/gjvvkhft3rCQQz1QCjEDGybM/28cpxec8/SzzM8XNpzZK+wTVimeibFB+d55wW11oHwTFge6dkBXj5O8pC6uqsTJhw3ABJdXMzx9lC9WgeCHRw3MOBsP5leerroaSpVBDU4bhAzGB4gf4G3hjCfU0/wKnjBknouzcUcb57kcJd6QnOCFCypL6XJ53jjhJqq6eU1GMExg5jByCD5HK+fILFvqratq7jdwXGDuEFukHyO17IHpOrWvuAYxA3OD5K/wKutSBXtCJbfjobT/6d2a3sFdqK1wd2QgA8BGEm3OFW0KtiEw3AZ5uCmuthK/gdL6hWYh1uQUtcds9UDnvgZbEISRmEexuFo5bi8v7h6/Iae9yTfgrshCddgHsaqUpvh6gmqTXewCb1wHebhBhxR13k2YU0FLukL7oYjMAYLcK1GagDoCDahD27BAoxCUl1XebgfPfxIDc0Fm3AUvoB5uAw96noAeQ02IQV3YAE+dZkasnvYhH64A3PwCSTUdb9oen7cBJswAPeaTg3B+7AJg3Af5uBjcPSJd0A1CpbUb+Av+Kjyh06TPE7L1SVRU6Ng4AmU4Kl6OKQaBVuwAp9BFu5Dva+pwqFRsJDsq5CBu7Cprnvh6gr1eBccwFmwsGAVbsDzcBs21PVQcBMsLFiH8Up2UV1vTN+4PHAfLCwoVrI/h3V1PbC8BgsLNuBLyMA4rKrrB3N19+rWXLCQ7NuQgTHH2a7oe450BAsLtuAryMBNWFHXVW26k/UFC8m+C1m47iC75XQHixJswz3IwFVQvpHXd3164E+wsKAEX0MWrkBBXXdJzz3gZ7AogQXfQhYuwT+eJqzv0wL/g4UFO/AdnIRR8DAwt+fX0KpgIdnfAzBVYOtf9QT/tTZYyFbIR8tMTPLrrKNsbVd0W4JFGco2D5eYmOSXWTZ31BP80b5gUbYp2/wu2TP1skN5D9fy1MaG35aZmOTBDBv7sjtnj0e1so0NfyzzwyQPZihWbXvuhHu4lt3sH6f46c9Ktq1pwIHdIC4jfVxiapHiDsUdDBgeUE/bb3YtzBvEZdqPVljcZGOn/t5+h4I64Woy7SdlphdZs0gl6u2GaTThMARXW91musBqqWZ2pwXLtNdKTBd4fFB2pwWL3eypAsvbpBLPNvJ1ZrCQ7HWL6arsRsGdQv57aaiPbFA3l/hC0y8nkUgkEolEIhEv/gPsQhHiWq60zQAAAABJRU5ErkJggg=='
const COMPO_MEDIUM_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAAD/klEQVR4Xu3bXW8UVRzH8c9W2mmlPJUHg20sDxJj1Bu9N8boWzDGO4yaCERJlCDPATVAQBATvTDGC0zwhXjhG7Dx0gAtikUspUKnQOvFoU17oN3d6Wy7s5nv5fmd3dnv/s+ZM7N7hpKSkpKSkpKSkpLqtMUNj/JE3FBQ2iqm2LZOd4fRNE5nUXzhtgps7/HmNs9v9NeYG3fiPrOoYRA0LW0VFbav89YLXt9qTWfc4XFU4oZC0FYxNWXHeq9stiqZE/1y2e835rTMpWgVDlXd0ePtF722JbatgeJUOHzS5zZ4ebPujjidoRUqHOZmV7t3XvJq/0K2NdDcwgkr2MkbrGy3clGqgWYVTmjnA67wHevjPDPNJ5zQwYdc5hs2g6m4V2aaSbiTDnZzhfPTqoGp3E6vzSGckLCHq3zFU3FuKrcFZbmFg+rHXOUMm+I8d5ZPuINO9jLIaTbGeYNYDuFwdfQeg5xiQ5w3lKUV7qSLd8HuPBeb2lkq4YQn2ccgR+NwKWm8cFDdzxAn6InzmslnLW6kcEI3BxjiOGun28P6Mjm7azXyWZI0TLiTbg4xxLFZqoshnwLnLpywisMMcYTVcW6mXHUJNGOFO1nNMa5xaB7VzDSXcMIaTnCNA3THeUyB53DCWr5giH2sjPMmJKtwQg+nuMandaoWrMIJ6znFIHvpivNGUddJbn7qEU7YwNlFq2aocD0fc2Fqe6eETZxjkD3Tv6oVk2rCQfVrrrJr+kZnkWSocCW3MV1NGPcZ50HcXFCqCafc5DP6OMdCf1MVg2rCgaB9kF7O8F+cZ6GuEbo8y1LKCEd4mpOMxXkhqEc4kDLK8Wnt23FenfzKlYH6hQMpt6e1P2c0zpuWrMKBlDG+pJfjjMT546lr9ubN4oQDQfskvRyrWbsu8vuO8hAOpNzhNL0c5WacxyzTTM5POBC0z9DH4Rq0l5y8hQPj3OUsvRwk+kc+w/jM8JJ5aIxwIGWc8/Sxn+G5ad1HzmcO1H3Yuhkn5QJ9fML1TOWq605jQRovHEiZ4Fue4QAZjpxPges+7OII2j+BC/wZ5/OSYVDMw9IKB8JWyJ/p56PatIstHJjgHt/Tzx6G4nwOrSAcSLnHD2xhF4Nx/pBW2+ORcp8f2Tq9VSliMrezVnMIB4L2RbbxPpdnRcVblmon5QEX2c5O/qAFh/SjTPCASzzLTq7HeWaaVTgwwSSX+JWxiYX39tdIER4BCL8Q35808LdbqZ4unSviPjNcubXwIwBFEJ7NyF0Dw0bG59VuNeFwBXJr3MCwfx+n3WrCgRnt34b9c1dPl672h1FrCgeC9mhqYJZ2NeFWITy91L9GX76bS5qcnC5OSkpKSkpKSkpKsvA/1V/qN3snSVUAAAAASUVORK5CYII='
const COMPO_FAST_ICON = 'data:image/png;base64,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vLDwG/eE8/s3BCkeAAAACXBIWXMAABcRAAAXEQHKJvM/AAADY2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPjxkYzpjcmVhdG9yPjxyZGY6U2VxIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpsaT5NaWs8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+PGV4aWY6RGF0ZVRpbWVPcmlnaW5hbD4yMDI1LTA4LTI4VDE1OjM3OjA1LjIwNTwvZXhpZjpEYXRlVGltZU9yaWdpbmFsPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wOC0yOFQxNTozNzowNS4yMDU8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjwvcmRmOlJERj48L3g6eG1wbWV0YT4NCjw/eHBhY2tldCBlbmQ9J3cnPz5miRcXAAAAIXRFWHRDcmVhdGlvbiBUaW1lADIwMjU6MDg6MjggMTU6Mzc6MDU6cUQUAAADgUlEQVR4Xu3aW28UZRzA4YfSdopWJBTx0GrxED+JiXdeGBNjNEaIGoVGSZRgOaaooaQIYqIXxniBiX4hjUaIBrotIRpCALFTDvXidZv2XUo709nt7nSe7NX73+7ub9+dTHY7VCqVSqVSqVQqy+uJFxptjBc6VC9zvMIw5+JhufTSxev8zhzvxfMSCalvco65+q2cwQkbeYs/FqSWMzik7rpXatmCu+nmHS40RJYtuA8MMdmQ13hbLrgrXmgrCd3s5AUeYyie59CuwQk9vMtFvmGADfFd8mm/4IRe3ucCX/E4mCtlcB+97OEip+upQdmCExJGmOQLHo3nJQoOqR8yyQTb43nh1i64lz72UuMEj8TzJlmL4AS8TY1xtsXzpmptcB+b2AX2MBDPW6BVwQkPsI8aR+JhKzU/OKTuZ4pjbI3nKzUXL+TTzOCEfkaZYowt9fVwgrm78K7LKeic1LTgPvo5yBRHF6SuRpvucMJDHGKKw2yO5+a3K1NAO+5wH5s5yjQHl0jNbUPGN2hpRQQnPMwxphmlP57HOvgYTtjCZ0yxjwfjeZHWeIcTtjLONB9nTO2wHU4YYJwae9kUz9tcluCEbZxcdWqOHc7yMu9vZY+UsJ1T1Bip/6rWmZYLDqlfMsnu+hedVcqxwy09Ld1mhjvxcodaLjjlCp8wxCluxvPWad0Oz2cfYJAJ/onneWQKWJvTUspVDvMEx7kRzztCluAg5Rpj9ezr8Xx5xW1XDtmDg5Tr9exPuRbP21be4CDlBp8zyBhX4/m9ZTp6i7a64CBkH2eQoyvOzqS496iI4CDlJicY5AhX4nks65Gc9f5LKC44CNkTDHFoBdktV3RwMMO/nGSQA/y9eJrj85njT5bQnOAgZYbTDLGfvxZPsz5zm36kG82QcoYhPuJyru3K9E3jvpofHKTM8jVPMUoLnznS2qcN2T+AM1yK50vq7P8Pp+AnhvlgZdmdHRzMcotvGWaEqXi+SI7DfglrFxyk3OI7drCbWjz/Xxl2eKGU23zP0/VLlSJ3SxYchOyzPFO/xHBeOYODlDuc5Vl28ifhI13QKy3oYQo3yx1+5Dl2crmwHe4EveBJztN4NWmpLi4NZsElnucNzsfzUuuhi9f4rWFvV7bDnSlkv8qv6yQ4CNkv88s6CQ7ms39eJ8FBDxt4iRfjSal1xwuVSqVSqVQqldb5D7qA8s4Uj0XKAAAAAElFTkSuQmCC'

// see ANIMATION_SPEED enum
const ANIMATION_SPEED = [
	{ name: 'SLOW', icon: COMPO_SLOW_ICON },
	{ name: 'MEDIUM', icon: COMPO_MEDIUM_ICON },
	{ name: 'FAST', icon: COMPO_FAST_ICON },
]

// see TRANSITION_MODE enum
const TRANSITION_MODE = [
	{ name: 'EASING', icon: COMPO_EASING_ICON },
	{ name: 'CUT', icon: COMPO_CUT_ICON },
]

// see TRANSITION_STATUS enum
const TRANSITION_STATUS = Object.freeze({
	TRANSITION_STARTED: "TRANSITION_STARTED",
	TRANSITION_RUNNING: "TRANSITION_RUNNING",
	TRANSITION_PAUSED: "TRANSITION_PAUSED",
	TRANSITION_RESUMED: "TRANSITION_RESUMED",
	TRANSITION_FINISHED: "TRANSITION_FINISHED"
});

class MixBoardInstance extends InstanceBase {
	currentChannel = 'CH_0'

	constructor(internal) {
		super(internal)

		this.programVideoInputId = -1
		this.previewVideoInputId = -1
		this.maxVideoInput = 0;
		this.videoInputList = []
		this.keyerList = []
		this.dataCallback = []
		this.takeMode = []
		this.KEYER_STATUS = {
			// companion feedbacks
			STOPPED: 0,
			PLAY_TO_PROGRAM: 1,
			PLAY_TO_PREVIEW: 2,
		}

		this.CHANNEL_CHOICES = [
			{ id: 'CH_0', label: 'CH-0' },
			{ id: 'CH_1', label: 'CH-1' },
			{ id: 'CH_2', label: 'CH-2' },
			{ id: 'CH_3', label: 'CH-3' },
		]

		this.TAKEMODE_CHOICES = [
			{ id: 'CUT', label: 'CUT' },
			{ id: 'FADE', label: 'FADE' },
			{ id: 'TR1', label: 'TR1' },
			{ id: 'TR2', label: 'TR2' },
			{ id: 'TR3', label: 'TR3' },
			{ id: 'TR4', label: 'TR4' },
		]

		this.KEYER_CHOICES = [
			{ id: 0, label: 'BKGD' },
			{ id: 1, label: 'KEY1' },
			{ id: 2, label: 'KEY2' },
			{ id: 3, label: 'KEY3' },
			{ id: 4, label: 'KEY4' },
		]

		this.transitionMode = [
			'CUT',
			'FADE',
			'TR1',
			'TR2',
			'TR3',
			'TR4',
		]

		this.keyers = [
			'BKGD',
			'KEY1',
			'KEY2',
			'KEY3',
			'KEY4',
		]

		// the transition status
		this.transitionStatus = ''

		// compositor control data
		this.currentCompoLayoutId = -1;
		this.currentCompoLayoutNames = []
		this.currentCompoCrosspointId = -1;
		this.currentCompoCrosspointVideoInputId = -1;
		this.currentCompoCrosspoints = []
		this.currentCompoSpeedIndex = 0
		this.currentCompoTransIndex = 0
	}

	async init(config) {
		this.config = config

		this.updateStatus(InstanceStatus.Ok)

		this.initActions()
		this.initFeedbacks()

		this.initTCP()
	}

	// When module gets deleted
	async destroy() {
		this.log('debug', 'destroy')

		if (this.socket) {
			this.socket.destroy()
			this.socket = null;
		}

		if (this.eventsocket) {
			this.eventsocket.destroy()
			this.eventsocket = null;
		}
	}

	async configUpdated(config) {
		this.config = config
		await this.init(config)
	}

	initTCP() {
		var ret = false;

		// dispose prev socket if present
		if (this.socket) {
			this.socket.destroy()
			this.socket = null
		}

		// dispose prev event socket if present
		if (this.eventsocket) {
			this.eventsocket.destroy()
			this.eventsocket = null
		}

		// fallback
		if (this.config.port === undefined) this.config.port = 701
		if (this.config.eventport === undefined) this.config.eventport = 801

		if (this.config.host) {
			this.socket = new TCPHelper(this.config.host, this.config.port)
			this.socket.on('status_change', (status) => this.updateStatus(status))
			this.socket.on('error', (err) => this.log('error', 'TCP error: ' + err))

			this.socket.on('connect', () => {
				this.updateStatus('ok')
				setTimeout(this.queryPresets.bind(this), 50)
				setTimeout(this.updateMixBoardInfo.bind(this), 50)
				setTimeout(this.updateCurrentCompoControlData.bind(this, this.config.control_videoinput_id), 50)
			})

			this.socket.on('data', (data) => {
				if (this.config.protocollog) this.log('debug', 'MixBoard response: ' + data.toString())
				this.tcpDataProcessor(data)
			})
		}

		this.eventsocket = new TCPHelper(this.config.host, this.config.eventport)
		this.eventsocket.on('error', (err) => {
			this.log('error', 'Network error: ' + err.message)
		})

		this.eventsocket.on('data', data => {
			if (this.config.protocollog) this.log('debug', 'MixBoard response: ' + data.toString())
			this.tcpDataProcessor(data)
		})

		return ret;
	}

	/**
	 * Store a VideoInput by ID and return its saved parameters
	 * @param {any} videoInputId id of the VideoInput name
	 */
	getVideoInput(videoInputId) {
		if (videoInputId >= 0) {
			if (this.videoInputList[videoInputId] == null) {
				this.videoInputList[videoInputId] = {
					name: 'IN ' + videoInputId,
					type: 'NONE'
				}
			}
			return this.videoInputList[videoInputId]
		}
		else {
			return {
				name: 'IN ' + videoInputId,
				type: 'NONE'
			}
		}
	}

	/**
	 * Store a Keyer by ID and return its saved parameters
	 * @param {any} keyerId id of the keyer
	 * @returns 
	 */
	getKeyer(keyerId) {
		if (keyerId >= 0) {
			if (this.keyerList[keyerId] == null) this.keyerList[keyerId] = {
				status: this.KEYER_STATUS.STOPPED,
				linkEnabled: false
			}
			return this.keyerList[keyerId]
		} else return {
			status: this.KEYER_STATUS.STOPPED,
			linkEnabled: false
		}
	}

	/**
	 * Add keyer presets into the given preset list
	 * 
	 * @param {*} presets the preset list to update
	 */
	addKeyersPresets(presets) {
		// add keyer buttons
		this.keyers.forEach((keyer, index) => {
			const id = keyer.toLowerCase()
			presets[id] = {
				type: 'button',
				category: 'Keyers',
				name: keyer,
				style: {
					text: keyer,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [],

						500: [
							{
								actionId: 'keyer_action',
								options: {
									channel: null,
									keyer_id: index,
									play_to_prev: true
								},
							}
						],

						up: [
							{
								actionId: 'keyer_action',
								options: {
									channel: null,
									keyer_id: index,
									play_to_prev: false
								},
							}
						]

					},
				],
				feedbacks: [
					{
						feedbackId: 'program_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_RED,
						},
					},
					{
						feedbackId: 'preview_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_GREEN,
						},
					},
					{
						feedbackId: 'stopped_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_BLACK,
						},
					},
				],
			}

			presets[`${keyer.toLowerCase()}_link`] = {
				type: 'button',
				category: 'Keyers',
				name: `${keyer} Link`,
				style: {
					text: `${keyer}`,
					size: '14',
					color: COLOR_WHITE,
					png64: KEYLINK_ICON,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'keylink_tap_action',
								options: {
									channel: null,
									keyer_id: index,
								},
							}
						],
						up: []
					},
				],
				feedbacks: [
					{
						feedbackId: 'link_keyer',
						options: {
							keyer_id: index,
						},
						style: {
							bgcolor: COLOR_ORANGE
						},
					},
				],
			}
		})
	}

	/**
	 * Add transition presets into the given preset list
	 * 
	 * @param {*} presets the preset list to update
	 */
	addTransitionsPresets(presets) {
		// add transition actions
		this.transitionMode.forEach(takeMode => {
			const id = `take_${takeMode.toLowerCase()}`
			presets[id] = {
				type: 'button',
				category: 'Transitions',
				name: `Take ${takeMode}`,
				style: {
					text: `${takeMode}`,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'take_action',
								options: {
									channel: null,
									take_mode: takeMode,
								},
							},
						],
						up: [],
					},
				],
			}
		})

		// set take mode presets
		this.TAKEMODE_CHOICES.forEach(choice => {
			let takeMode = choice.id

			// auto take
			presets[`set_takemode_${takeMode}`] = {
				type: 'button',
				category: 'Transitions',
				name: `Set \n${takeMode}`,
				style: {
					text: `SET\n${takeMode}`,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'set_takemode_action',
								options: {
									channel: null,
									take_mode: takeMode,
								},
							},
						],
						up: [],
					},
				],
				feedbacks: [
					{
						feedbackId: 'takemode_changed',
						options: {
							take_mode: takeMode,
						},
						style: {
							bgcolor: COLOR_ORANGE
						},
					},
				],
			}
		});

		// auto take
		presets[`auto_take`] = {
			type: 'button',
			category: 'Transitions',
			name: `Auto Take`,
			style: {
				text: 'AUTO\nTAKE',
				size: '14',
				color: COLOR_WHITE,
				show_topbar: false
			},
			steps: [
				{
					down: [
						{
							actionId: 'autotake_action',
							options: {
								channel: null,
							},
						},
					],
					up: [],
				},
			],
		}

		// resume back
		presets[`resume_backward`] = {
			type: 'button',
			category: 'Transitions',
			name: `Resume Backward`,
			style: {
				text: ``,
				size: '18',
				color: COLOR_WHITE,
				show_topbar: false
			},
			steps: [
				{
					down: [
						{
							actionId: 'resume_action',
							options: {
								channel: null,
								play_direction: 'BACKWARD',
							},
						},
					],
					up: [],
				},
			],
			feedbacks: [
				{
					feedbackId: 'update_resume_button',
					options: {
					},
					style: {
						bgcolor: COLOR_ORANGE
					},
				},
			],
		}

		// resume forward
		presets[`resume_forward`] = {
			type: 'button',
			category: 'Transitions',
			name: `Resume Forward`,
			style: {
				text: ``,
				size: '18',
				color: COLOR_WHITE,
				show_topbar: false
			},
			steps: [
				{
					down: [
						{
							actionId: 'resume_action',
							options: {
								channel: null,
								play_direction: 'FORWARD',
							},
						},
					],
					up: [],
				},
			],
			feedbacks: [
				{
					feedbackId: 'update_resume_button',
					options: {
					},
					style: {
						bgcolor: COLOR_ORANGE
					},
				},
			],
		}
	}

	/**
	 * Add channel presets into the given preset list
	 * 
	 * @param {*} presets the preset list to update
	 */
	addChannelsPresets(presets) {
		this.CHANNEL_CHOICES.forEach((item) => {
			let id = item.id;
			let label = item.label
			presets[id] = {
				type: 'button',
				category: 'Channels',
				name: `${label}`,
				style: {
					text: `${label}`,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'channel_action',
								options: {
									channel: id.toString(),
								},
							},
						],
						up: [],
					},
				],
				feedbacks: [
					{
						feedbackId: 'channel_changed',
						options: {
							channel: id,
						},
						style: {
							bgcolor: COLOR_ORANGE
						},
					},
				],
			}
		})
	}

	/**
	 * Add "execute" buttons to preset list
	 * 
	 * @param {*} presets the preset list 
	 */
	addControlExecutePresets(presets) {
		for (let i = 0; i < MAX_EXECUTE_BUTTON; i++) {
			presets['execute_button_' + i] = {
				type: 'button',
				category: 'Control Execute',
				name: `Execute_` + i,
				style: {
					text: `Execute ` + i,
					size: '14',
					color: COLOR_WHITE,
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'control_execute_action',
								options: {
									execute_id: i,
								},
							},
						],
						up: [],
					},
				],

				feedbacks: [
					{
						feedbackId: 'update_execute_gui',
						options: {
							execute_id: i,
						},
					},
				],
			};
		}
	}

	/**
	 * Add the "assign" buttons to preset list
	 * 
	 * @param {*} presets  the preset list
	 */
	addControlAssignPresets(presets) {
		for (let i = 0; i < MAX_ASSIGN_BUTTON; i++) {
			let assignId = i

			presets['assign_button_' + i] = {
				type: 'button',
				category: 'Control Assign',
				name: `Assign_` + i,
				style: {
					text: `Assign ` + i,
					size: '14',
					color: COLOR_WHITE,
					png64: CROSSPOINT_ICONS[assignId],
					show_topbar: false
				},
				steps: [
					{
						down: [
							{
								actionId: 'control_assign_action',
								options: {
									assign_id: assignId,
								},
							},
						],
						up: [],
					},
				],

				feedbacks: [
					{
						feedbackId: 'update_assign_gui',
						options: {
							assign_id: assignId,
						},
					},
				],
			};
		}
	}

	/**
	 * Query contents from MixBoard and prepare a bank of presets
	 */
	queryPresets() {
		this.sendCommand(`MBC_GETVIDEOINPUTLIST`, (data) => {
			const presets = {}

			if (data.toString().trim() != '') {
				// register keyer presets
				this.addKeyersPresets(presets)

				// transitions presets
				this.addTransitionsPresets(presets)

				// channel presets
				this.addChannelsPresets(presets)

				// control presets
				this.addControlExecutePresets(presets)
				this.addControlAssignPresets(presets);

				// control the program videoinput
				presets['control_program'] = {
					type: 'button',
					category: 'Control Actions',
					name: `CONTROL PGM`,
					style: {
						text: 'CTRL PGM',
						size: '14',
						color: COLOR_WHITE,
						bgcolor: COLOR_BLACK,
						show_topbar: false
					},
					steps: [
						{
							down: [
								{
									actionId: 'control_program_input_action',
								},
							],
							up: [],
						},
					],
				}

				// control the preview videoinput
				presets['control_preview'] = {
					type: 'button',
					category: 'Control Actions',
					name: `CONTROL PVW`,
					style: {
						text: 'CTRL PVW',
						size: '14',
						color: COLOR_WHITE,
						bgcolor: COLOR_BLACK,
						show_topbar: false
					},
					steps: [
						{
							down: [
								{
									actionId: 'control_preview_input_action',
								},
							],
							up: [],
						},
					],
				}

				// parse json
				var jsonData = atob(data.toString().trim())
				const obj = JSON.parse(jsonData);

				this.maxVideoInput = parseInt(obj.MAX_SUPPORTED_INPUTS);

				obj.VIDEOINPUT.forEach((input) => {
					const inputName = input.NAME.toString()
					const inputType = input.TYPE.toString()
					const inputId = parseInt(input.VIDEOINPUTID)

					// update input name 
					var videoInput = this.getVideoInput(inputId)
					videoInput.name = inputName
					videoInput.type = inputType

					const pgmId = `pgm_in_${inputId}`
					presets[pgmId] = {
						type: 'button',
						category: 'Program',
						name: `PGM ${inputId}`,
						style: {
							text: inputName,
							size: '14',
							color: COLOR_WHITE,
							bgcolor: COLOR_BLACK,
							png64: OVERLAY_PROGRAM_ICON,
							show_topbar: false
						},
						steps: [
							{
								down: [
									{
										actionId: 'set_program_action',
										options: {
											channel: null,
											videoinput_id: inputId,
										},
									},
								],
								up: [],
							},
						],
						feedbacks: [
							{
								feedbackId: 'program_videoinput',
								options: {
									videoinput_id: inputId,
								},
								style: {
									bgcolor: COLOR_RED,
								},
							},
							{
								feedbackId: 'name_videoinput',
								options: {
									videoinput_id: inputId,
								},
							},
							{
								feedbackId: 'highlight_videoinput_control',
								options: {
									videoinput_id: inputId,
								},
								style: {
									png64: HIGHLIGHT_CONTROL_VIDEOINPUT_ICON
								},
							}
						],
					}

					const pvwId = `pvw_in_${inputId}`
					presets[pvwId] = {
						type: 'button',
						category: 'Preview',
						name: `PVW ${inputId}`,
						style: {
							text: inputName,
							size: '14',
							color: COLOR_WHITE,
							png64: OVERLAY_PROGRAM_ICON,
							show_topbar: false
						},
						steps: [
							{
								down: [
									{
										actionId: 'set_preview_action',
										options: {
											channel: null,
											videoinput_id: inputId,
										},
									},
								],
								up: [],
							},
						],
						feedbacks: [
							{
								feedbackId: 'preview_videoinput',
								options: {
									videoinput_id: inputId,
								},
								style: {
									bgcolor: COLOR_GREEN,
								},
							},
							{
								feedbackId: 'name_videoinput',
								options: {
									videoinput_id: inputId,
								},
							},
							{
								feedbackId: 'highlight_videoinput_control',
								options: {
									videoinput_id: inputId,
								},
								style: {
									png64: HIGHLIGHT_CONTROL_VIDEOINPUT_ICON
								},
							}
						],
					}

					const crbId = `crb_in_${inputId}`
					presets[crbId] = {
						type: 'button',
						category: 'Control VideoInput Crosspoints',
						name: `CRB ${inputId}`,
						style: {
							text: inputName,
							size: '14',
							color: COLOR_WHITE,
							bgcolor: COLOR_BLACK,
							show_topbar: false
						},
						steps: [
							{
								down: [
									{
										actionId: 'control_assign_crosspoint_action',
										options: {
											videoinput_id: inputId,
										},
									},
								],
								up: [],
							},
						],
						feedbacks: [
							{
								feedbackId: 'update_compo_crosspoint_gui',
								options: {
									videoinput_id: inputId,
								},
								style: {
									bgcolor: COLOR_ORANGE,
								},
							},
							{
								feedbackId: 'name_videoinput',
								options: {
									videoinput_id: inputId,
								},
							},
						],
					}
				})

				// refresh input names
				this.checkFeedbacks('name_videoinput')
			}

			this.setPresetDefinitions(presets)
		})
	}

	/**
	 * Util to read parameters from event port
	 * @param {any} query event body
	 * @param {any} variable key to return
	 */
	getQueryVariable(query, variable) {
		const escapeRegExp = s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');

		// (^|[\s,])   -> start of string, any whitespace, or a comma before the key
		// VAR\s*=\s*  -> key=value with optional spaces
		// "((?:\\.|[^"\\])*)" -> quoted value allowing \" escapes
		// |([^,\s]+)  -> or unquoted run up to comma or whitespace
		const re = new RegExp(
			`(?:^|[\\s,])${escapeRegExp(variable)}\\s*=\\s*(?:"((?:\\\\.|[^"\\\\])*)"|([^,\\s]+))`
		);

		const m = re.exec(query);
		if (!m) return null;

		// m[1] is quoted (with escapes), m[2] is unquoted
		if (m[1] !== undefined) {
			// unescape \" inside quoted strings
			return m[1].replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}
		return m[2];
	}

	/**
	* Process data recived by ClassX MixBoard instances
	* @param {any} data data recieved
	*/
	tcpDataProcessor(tcpdata) {
		tcpdata
			.toString()
			.split('\n')
			.forEach((data) => {
				if (data.trim() == '') return

				if (data.includes('Welcome to MixBoard')) return
				if (data.trim().startsWith('PING')) return
				if (data.trim().startsWith('Ok')) return

				let dataStr = data.trim();

				if (dataStr.startsWith('MIXBOARDEVENT')) {
					let type = this.getQueryVariable(dataStr, 'TYPE')

					if (type === 'PROGRAM_CHANGED') {
						let channel = this.getQueryVariable(dataStr, 'CHANNEL')

						// it must be the current channel 
						if (channel !== this.currentChannel) return

						let videoInputId = parseInt(this.getQueryVariable(dataStr, 'VIDEOINPUTID'))

						// update program video input id
						this.programVideoInputId = videoInputId;

						this.checkFeedbacks('program_videoinput');
						return
					}
					else if (type === 'PREVIEW_CHANGED') {
						let channel = this.getQueryVariable(dataStr, 'CHANNEL')

						// it must be the current channel 
						if (channel !== this.currentChannel) return

						let videoInputId = parseInt(this.getQueryVariable(dataStr, 'VIDEOINPUTID'))

						// update status
						this.previewVideoInputId = videoInputId;

						// check feedbacks	
						this.checkFeedbacks('preview_videoinput');
						return
					}
					else if (type === 'TRANSITION_STATUS_CHANGED') {
						let channel = this.getQueryVariable(dataStr, 'CHANNEL')
						let status = this.getQueryVariable(dataStr, 'STATUS').toString().trim()

						// it must be the current channel 
						if (channel !== this.currentChannel) return

						// store new status
						this.transitionStatus = status

						switch (status) {

							case TRANSITION_STATUS.TRANSITION_FINISHED:
								this.updateMixBoardInfo()
								break

							case TRANSITION_STATUS.TRANSITION_RESUMED:
							case TRANSITION_STATUS.TRANSITION_PAUSED:
								// highlight resume buttons according with transition status
								this.checkFeedbacks('update_resume_button')
								break
						}

						return
					}
					else if (type === 'KEYER_STATUS_CHANGED') {
						let channel = this.getQueryVariable(dataStr, 'CHANNEL')
						let keyerId = parseInt(this.getQueryVariable(dataStr, 'KEYERID'))
						let status = this.getQueryVariable(dataStr, 'STATUS').toString().trim()

						// it must be the current channel 
						if (channel !== this.currentChannel) return

						if (status === 'PLAY_TO_PREVIEW') {
							this.getKeyer(keyerId).status = this.KEYER_STATUS.PLAY_TO_PREVIEW
						}
						else if (status === 'PLAY_TO_PROGRAM') {
							this.getKeyer(keyerId).status = this.KEYER_STATUS.PLAY_TO_PROGRAM
						}
						else if (status === 'STOP') {
							this.getKeyer(keyerId).status = this.KEYER_STATUS.STOPPED
						}

						this.checkFeedbacks()
						return
					}
					else if (type === 'KEYER_TRANSITIONLINK_CHANGED') {
						let channel = this.getQueryVariable(dataStr, 'CHANNEL')
						let keyerId = parseInt(this.getQueryVariable(dataStr, 'KEYERID'))
						let link = this.getQueryVariable(dataStr, 'LINK').toLowerCase() === 'true'

						// it must be the current channel 
						if (channel !== this.currentChannel) return

						this.getKeyer(keyerId).linkEnabled = link

						this.checkFeedbacks('link_keyer')
						return
					}
				}
				else if (dataStr.startsWith('VIDEOINPUTEVENT')) {
					let videoInputId = parseInt(this.getQueryVariable(dataStr, 'VIDEOINPUTID'))
					let type = this.getQueryVariable(dataStr, 'TYPE')
					let value = this.getQueryVariable(dataStr, 'VALUE')

					let controlVideoInputId = this.config.control_videoinput_id
					let isControlVideoInput = videoInputId == controlVideoInputId

					// refresh presets
					switch (type) {
						case 'NAME_CHANGED':
							this.queryPresets();
							return

						case 'VIDEOINPUT_CHANGED':
							this.queryPresets();
							this.updateCurrentCompoControlData(controlVideoInputId);
							return

						case 'COMPOSITOR_LAYOUTCHANGED':
							if (isControlVideoInput) {
								this.currentCompoLayoutId = value
								this.checkFeedbacks('update_execute_gui')
								this.sendCommand(`UPDATEGUI`)
							}
							return

						case 'COMPOSITOR_ANIMATION_SPEED_CHANGED':
							if (isControlVideoInput) {
								this.currentCompoSpeedIndex = ANIMATION_SPEED.findIndex(item => item.name === value)
								this.checkFeedbacks('update_execute_gui')
								this.sendCommand(`UPDATEGUI`)
							}
							return

						case 'COMPOSITOR_TRANSITION_MODE_CHANGED':
							if (isControlVideoInput) {
								this.currentCompoTransIndex = TRANSITION_MODE.findIndex(item => item.name === value)
								this.checkFeedbacks('update_execute_gui')
								this.sendCommand(`UPDATEGUI`)
							}
							return

						case 'COMPOSITOR_COMPOSITION_MODIFIED':
							if (isControlVideoInput) {
								this.updateCompositionDataFromJson(atob(value))
								this.checkFeedbacks('update_execute_gui')
							}

							break
					}
				}
				else if (dataStr.startsWith('SERVEREVENT')) {
					// unhandled
					return
				}

				if (this.dataCallback.length > 0) {
					this.dataCallback.shift()(dataStr)
					return
				}

				this.log('error', 'Network unhandled recv: ' + data)
			})
	}

	/**
	 * Update MixBoard info 
	 */
	updateMixBoardInfo() {
		this.sendCommand(`MBC_GETMIXBOARDINFO ` + this.currentChannel, (data) => {
			var jsonData = atob(data.toString().trim())
			const jsonObj = JSON.parse(jsonData);

			let previewId = parseInt(jsonObj.PREVIEW.toString());
			let programId = parseInt(jsonObj.PROGRAM.toString());

			// update trans status
			this.transitionStatus = jsonObj.TRANSITION_STATUS

			// update status
			this.previewVideoInputId = previewId
			this.programVideoInputId = programId

			let keyers = jsonObj.KEYER
			keyers.forEach(keyerObj => {
				let kId = keyerObj.KEYERID
				let status = keyerObj.STATUS
				let link = keyerObj.LINK

				let kStatus = this.KEYER_STATUS.STOPPED
				if (status === "PLAY_TO_PREVIEW")
					kStatus = this.KEYER_STATUS.PLAY_TO_PREVIEW
				else if (status === "PLAY_TO_PROGRAM")
					kStatus = this.KEYER_STATUS.PLAY_TO_PROGRAM

				let keyer = this.getKeyer(kId)
				keyer.status = kStatus
				keyer.linkEnabled = link
			})

			this.checkFeedbacks();
		})
	}

	/**
	 * Set instance feedbacks
	 */
	initFeedbacks() {
		this.setFeedbackDefinitions({
			preview_videoinput: {
				type: 'boolean',
				name: 'VideoInput on Preview',
				description: 'The preview VideoInput has changed',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.videoinput_id)
					return this.previewVideoInputId == id
				},
			},

			program_videoinput: {
				type: 'boolean',
				name: 'VideoInput on Program',
				description: 'The program VideoInput has changed',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.videoinput_id)
					return this.programVideoInputId == id
				},
			},

			name_videoinput: {
				type: 'advanced',
				name: 'VideoInput name changed',
				description: 'The VideoInput name has changed',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					return {
						text: this.getVideoInput(feedback.options.videoinput_id).name || `IN ${feedback.options.videoinput_id}`
					};
				},
			},

			stopped_keyer: {
				type: 'boolean',
				name: 'Keyer stopped',
				description: 'The Keyer has stopped',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
						min: 0,
						max: 4
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					const result = this.getKeyer(id).status == this.KEYER_STATUS.STOPPED
					return result
				},
			},

			preview_keyer: {
				type: 'boolean',
				name: 'Keyer on Preview',
				description: 'The Keyer has played to preview',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					const result = this.getKeyer(id).status == this.KEYER_STATUS.PLAY_TO_PREVIEW
					return result
				},
			},

			program_keyer: {
				type: 'boolean',
				name: 'Keyer on Program',
				description: 'The Keyer has played to Program',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					const result = this.getKeyer(id).status == this.KEYER_STATUS.PLAY_TO_PROGRAM
					return result
				},
			},

			link_keyer: {
				type: 'boolean',
				name: 'Key link',
				description: 'The Key link status has changed',
				options: [
					{
						id: 'keyer_id',
						type: 'number',
						label: 'Keyer ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.keyer_id)
					return this.getKeyer(id).linkEnabled
				},
			},

			channel_changed: {
				type: 'boolean',
				name: 'Current channel',
				description: 'The current channel has changed',
				options: [
					{
						id: 'channel',
						type: 'dropdown',
						label: 'Channel',
						choices: this.CHANNEL_CHOICES,
						default: "CH_0",
					},
				],
				callback: (feedback) => {
					return feedback.options.channel == this.currentChannel
				},
			},

			takemode_changed: {
				type: 'boolean',
				name: 'Take mode changed',
				description: 'The current Take mode has changed',
				options: [
					{
						id: 'take_mode',
						type: 'dropdown',
						label: 'Take Mode',
						choices: this.TAKEMODE_CHOICES,
						default: "CUT",
					},
				],
				callback: (feedback) => {
					let currentTakeMode = this.takeMode[this.currentChannel] || 'CUT';
					return currentTakeMode == feedback.options.take_mode
				},
			},

			update_execute_gui: {
				type: 'advanced',
				name: 'Update execute buttons state',
				description: 'Update the execute buttons state',
				options: [
					{
						id: 'execute_id',
						type: 'number',
						label: 'Execute ID',
						default: 0,
						min: 0,
						max: MAX_EXECUTE_BUTTON,
					},
				],
				callback: (feedback) => {
					let executeId = feedback.options.execute_id

					let text = ''
					let bg = COLOR_BLACK
					let icon = ''

					switch (this.getVideoInput(this.config.control_videoinput_id).type) {
						case 'COMPOSITOR':
							// layout buttons [0-MAX_COMPO_LAYOUT]
							if (executeId < MAX_COMPO_LAYOUT) {
								text = this.currentCompoLayoutNames[executeId]
								bg = this.currentCompoLayoutId == executeId ? COLOR_ORANGE : COLOR_BLACK
							}
							else if (executeId == COMPO_SPEED_MODE_ID) {
								icon = ANIMATION_SPEED[this.currentCompoSpeedIndex].icon
								bg = COLOR_BLACK
							}
							else if (executeId == COMPO_TRANSITION_MODE_ID) {
								icon = TRANSITION_MODE[this.currentCompoTransIndex].icon
								bg = COLOR_BLACK
							}
							break

						default:
							text = ''
							bg = COLOR_BLACK
							icon = ''
							break;
					}

					return {
						text: text,
						bgcolor: bg,
						png64: icon
					};
				},
			},

			update_assign_gui: {
				type: 'advanced',
				name: 'Update assign buttons state',
				description: 'Update the assign buttons state',
				options: [
					{
						id: 'assign_id',
						type: 'number',
						label: 'Assign ID',
						default: 0,
						min: 0,
						max: MAX_ASSIGN_BUTTON,
					},
				],
				callback: (feedback) => {
					let text = ""
					let icon = ''
					let bg = COLOR_BLACK
					switch (this.getVideoInput(this.config.control_videoinput_id).type) {
						case 'COMPOSITOR':
							let id = feedback.options.assign_id
							let selectedCrosspoint = this.currentCompoCrosspointId
							let visible = id < this.currentCompoCrosspoints.length
							let selected = selectedCrosspoint == id

							text = visible ? this.currentCompoCrosspoints[id].name : ''
							icon = visible ? (selected ? CROSSPOINT_SELECTED_ICONS[id] : CROSSPOINT_ICONS[id]) : ''
							bg = visible ? (selected ? COLOR_ORANGE : COLOR_BLACK) : COLOR_BLACK
							break
					}

					return {
						text: text,
						png64: icon,
						bgcolor: bg
					};
				},
			},

			update_resume_button: {
				type: 'boolean',
				name: 'Update the resume button according to transition status of the current channel',
				description: 'Update the resume button according to transition status of the current channel',
				options: [

				],
				callback: (feedback) => {
					return this.transitionStatus === TRANSITION_STATUS.TRANSITION_PAUSED
				},
			},

			highlight_videoinput_control: {
				type: 'boolean',
				name: 'Highlight the PGM/PVW VideoInput button when controlled',
				description: 'Highlight the PGM/PVW VideoInput button when controlled',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
						min: 0,
						max: MAX_ASSIGN_BUTTON,
					},
				],
				callback: (feedback) => {
					return this.config.control_videoinput_id == feedback.options.videoinput_id
				},
			},

			update_compo_crosspoint_gui: {
				type: 'boolean',
				name: 'Update the Compositor crosspoint VideoInput buttons',
				description: 'Update the Compositor crosspoint VideoInput buttons',
				options: [
					{
						id: 'videoinput_id',
						type: 'number',
						label: 'VideoInput ID',
						default: 0,
					},
				],
				callback: (feedback) => {
					const id = parseInt(feedback.options.videoinput_id)
					const result = this.currentCompoCrosspointVideoInputId == id
					return result
				},
			},

		})
	}

	initActions() {
		this.setActionDefinitions({
			channel_action: {
				name: 'Set current channel',
				description: 'Select the current output channel',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
				],
				callback: ({ options }) => {
					this.currentChannel = options.channel;
					this.updateMixBoardInfo()
				},
			},

			keyer_action: {
				name: 'Toggle Keyer',
				description: 'Play/Stop the given keyer to program or preview following the "Play to preview" option',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Keyer',
						id: 'keyer_id',
						choices: this.KEYER_CHOICES,
						default: 1,
					},
					{
						type: 'checkbox',
						label: 'Play to preview',
						id: 'play_to_prev',
						default: false,
					},
				],
				callback: ({ options }) => {
					// channel
					let channel = options.channel ?? this.currentChannel

					// toggle
					if (this.getKeyer(options.keyer_id).status == this.KEYER_STATUS.STOPPED) {
						// respect the target
						let target = options.play_to_prev ? 'PREVIEW' : 'PROGRAM'
						this.sendCommand(`MBC_PLAYKEYER CHANNEL="${channel}",KEYERID="${options.keyer_id}",TARGET="${target}"`)
					}
					else {
						this.sendCommand(`MBC_STOPKEYER CHANNEL="${channel}",KEYERID="${options.keyer_id}"`)
					}
				},
			},

			keylink_tap_action: {
				name: 'Key link',
				description: 'Enable/disable the keyer transition link option',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Keyer',
						id: 'keyer_id',
						choices: this.KEYER_CHOICES,
						default: 1,
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					let link = !this.getKeyer(options.keyer_id).linkEnabled
					this.sendCommand(`MBC_SETLINKKEYERTOTRANSITION CHANNEL="${channel}",KEYERID="${options.keyer_id}",LINK=${link}`)
					this.sendCommand(`UPDATEGUI`)
				},
			},

			set_takemode_action: {
				name: 'Set take mode',
				description: 'Select the take mode to execute on AUTO take command',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Take Mode',
						id: 'take_mode',
						choices: this.TAKEMODE_CHOICES,
						default: 'CUT',
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					this.takeMode[channel] = options.take_mode;
					this.checkFeedbacks('takemode_changed')
				},
			},

			autotake_action: {
				name: 'Auto Take',
				description: 'Auto take transition following the current take mode',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					let takeMode = this.takeMode[channel] ?? 'CUT';
					const cmd = `MBC_TAKE CHANNEL="${channel}",TAKE_MODE="${takeMode}"`
					this.sendCommand(cmd)
				},
			},

			take_action: {
				name: 'Take',
				description: 'Take transition',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'dropdown',
						label: 'Take Mode',
						id: 'take_mode',
						choices: this.TAKEMODE_CHOICES,
						default: 'CUT',
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_TAKE CHANNEL="${channel}",TAKE_MODE="${options.take_mode}"`
					this.sendCommand(cmd)
				},
			},

			resume_action: {
				name: 'Resume transition',
				description: 'Resume the paused transition following the given direction',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'textinput',
						label: 'Play direction',
						id: 'play_direction',
						choices: [
							{ id: 'BACKWARD', label: 'Backward' },
							{ id: 'FORWARD', label: 'Forward' },
						],
						default: 'FORWARD',
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_RESUMETRANSITION CHANNEL="${channel}",PLAY_DIRECTION="${options.play_direction}"`
					this.sendCommand(cmd)
				},
			},

			set_preview_action: {
				name: 'Set Preview VideoInput',
				description: 'Set the VideoInput to display to preview',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'number',
						label: 'VideoInput ID',
						id: 'videoinput_id',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_SETPREVIEWVIDEOINPUTID CHANNEL="${channel}",VIDEOINPUTID="${options.videoinput_id}"`
					this.sendCommand(cmd)
					this.sendCommand(`UPDATEGUI`)
				},
			},

			set_program_action: {
				name: 'Set Program VideoInput',
				description: 'Set the VideoInput to display to program',
				options: [
					{
						type: 'dropdown',
						label: 'Channel',
						id: 'channel',
						choices: this.CHANNEL_CHOICES,
						default: 'CH_0',
					},
					{
						type: 'number',
						label: 'VideoInput ID',
						id: 'videoinput_id',
						default: 0,
						min: 0,
						max: 24
					},
				],
				callback: ({ options }) => {
					let channel = options.channel ?? this.currentChannel
					const cmd = `MBC_SETPROGRAMVIDEOINPUTID CHANNEL="${channel}",VIDEOINPUTID="${options.videoinput_id}"`
					this.sendCommand(cmd)
					this.sendCommand(`UPDATEGUI`)
				},
			},

			command_action: {
				name: 'Execute command',
				description: 'Execute custom MBC command',
				options: [
					{
						id: 'command',
						type: 'textinput',
						label: 'Command'
					},
				],
				callback: ({ options }) => {
					const cmd = `${options.command}`
					this.sendCommand(cmd)
				},
			},

			control_program_input_action: {
				name: 'Control the program VideoInput',
				description: 'Control the program VideoInput',
				callback: () => {
					let controlVideoInput = this.programVideoInputId
					this.config.control_videoinput_id = controlVideoInput
					this.saveConfig()

					this.updateCurrentCompoControlData(controlVideoInput)
				},
			},

			control_preview_input_action: {
				name: 'Control the preview VideoInput',
				description: 'Control the preview VideoInput',
				callback: () => {
					let controlVideoInput = this.previewVideoInputId
					this.config.control_videoinput_id = controlVideoInput
					this.saveConfig()

					this.updateCurrentCompoControlData(controlVideoInput)
				},
			},

			control_execute_action: {
				name: 'Execute action',
				description: 'The execute action',
				options: [
					{
						type: 'number',
						label: 'Execute ID',
						id: 'execute_id',
						default: 0,
						min: 0,
						max: MAX_EXECUTE_BUTTON
					}
				],
				callback: ({ options }) => {
					var executeId = options.execute_id
					var controlVideoInput = this.config.control_videoinput_id

					switch (this.getVideoInput(controlVideoInput).type) {
						case 'COMPOSITOR':
							// layout buttons [0-7]
							if (executeId < MAX_COMPO_LAYOUT) {

								this.currentCompoLayoutId = executeId
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="setActiveLayout ' + executeId + '"')
							}
							else if (executeId == COMPO_SPEED_MODE_ID) {

								this.currentCompoSpeedIndex = (this.currentCompoSpeedIndex + 1) % ANIMATION_SPEED.length
								let speed = ANIMATION_SPEED[this.currentCompoSpeedIndex].name
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="setAnimationSpeed ' + speed + '"')
							}
							else if (executeId == COMPO_TRANSITION_MODE_ID) {

								this.currentCompoTransIndex = (this.currentCompoTransIndex + 1) % TRANSITION_MODE.length
								let transitionMode = TRANSITION_MODE[this.currentCompoTransIndex].name
								this.sendCommand('MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID=' + controlVideoInput + ' COMMAND="setTransitionMode ' + transitionMode + '"')
							}
							break
					}
				},
			},

			control_assign_action: {
				name: 'Assign action',
				description: 'Generic assign action',
				options: [
					{
						type: 'number',
						label: 'Assign ID',
						id: 'assign_id',
						default: 0,
						min: 0,
						max: MAX_ASSIGN_BUTTON
					}
				],
				callback: ({ options }) => {
					var controlVideoInput = this.config.control_videoinput_id

					switch (this.getVideoInput(controlVideoInput).type) {
						case 'COMPOSITOR':
							// select the crosspoint to be assigned from assign action
							this.currentCompoCrosspointId = options.assign_id
							this.updateCurrentCompoControlData(controlVideoInput);
							break
					}
				},
			},

			control_assign_crosspoint_action: {
				name: 'Assign crosspoint action',
				description: 'Assign the VideoInput to the selected crosspoint',
				options: [
					{
						type: 'number',
						label: 'VideoInput ID',
						id: 'videoinput_id',
						default: 0,
						min: 0,
						max: 24
					}
				],
				callback: ({ options }) => {
					var videoInputIdToControl = this.config.control_videoinput_id
					var videoInputIdToAssign = options.videoinput_id

					if (this.getVideoInput(videoInputIdToControl).type === 'COMPOSITOR') {
						if (this.currentCompoCrosspointId >= 0) {

							// update the current crosspoint videoinput id
							this.currentCompoCrosspointVideoInputId = videoInputIdToAssign

							this.sendCommand(`MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${videoInputIdToControl}", COMMAND="setCrossPointVideoInputId CROSSPOINTID=${this.currentCompoCrosspointId}, VIDEOINPUTID=${videoInputIdToAssign}"`)
							this.sendCommand(`UPDATEGUI`)
							this.checkFeedbacks('update_compo_crosspoint_gui')
						}
					}
				},
			},
		})
	}

	/**
	 * Update the composition data from the given json string 
	 * 
	 * @param {*} jsonString 
	 */
	updateCompositionDataFromJson(jsonString) {
		const obj = JSON.parse(jsonString);

		this.maxVideoInput = parseInt(obj.MAX_SUPPORTED_INPUTS);

		// update current compo params
		this.currentCompoLayoutId = obj.ACTIVELAYOUT
		this.currentCompoLayoutNames = obj.LAYOUT_NAMES
		this.currentCompoSpeedIndex = ANIMATION_SPEED.findIndex(item => item.name === obj.ANIMATION_SPEED)
		this.currentCompoTransIndex = TRANSITION_MODE.findIndex(item => item.name === obj.TRANSITION_MODE)
		this.currentCompoCrosspoints = obj.CROSSPOINT_INFO.map(cp => ({
			id: cp.ID,
			name: cp.NAME
		}));

		this.currentCompoCrosspointVideoInputId = this.currentCompoCrosspoints?.[this.currentCompoCrosspointId]?.id ?? -1;

		// update buttons
		this.checkFeedbacks('update_compo_crosspoint_gui', 'update_execute_gui', 'update_assign_gui', 'highlight_videoinput_control')
	}

	/**
	 * Update the current compositor control data 
	 * 
	 * @param {*} controlVideoInputId 
	 */
	updateCurrentCompoControlData(controlVideoInputId) {
		if (this.getVideoInput(controlVideoInputId).type === 'COMPOSITOR') {
			this.sendCommand(`MBC_SENDVIDEOINPUTCOMMAND VIDEOINPUTID="${controlVideoInputId}", COMMAND="getCompositorInfo"`, (data) => {
				var result = data.toString().trim()
				if (result != '') {
					// parse json
					var jsonData = atob(result)

					// read compo data from json and update 
					this.updateCompositionDataFromJson(jsonData)
				}
			})
		}
		else {
			// reset current compo params
			this.currentCompoCrosspointId = -1
			this.currentCompoLayoutId = -1
			this.currentCompoLayoutNames = []
			this.currentCompoCrosspointVideoInputId = -1
			this.currentCompoTransIndex = 0
			this.currentCompoSpeedIndex = 0
			this.currentCompoCrosspoints = []

			// update buttons
			this.checkFeedbacks('update_compo_crosspoint_gui', 'update_execute_gui', 'update_assign_gui', 'highlight_videoinput_control')
		}
	}

	/**
	 * Send command to ClassX MixBoard instance
	 * @param {any} cmd coomand to execute
	 * @param {any} cb optional, data callback to execute in response to command
	 */
	sendCommand(cmd, cb) {
		if (cmd !== undefined && cmd != '') {
			if (this.socket) {// && this.socket.isConnected()) {
				if (cb) this.dataCallback.push(cb)
				this.socket.send(cmd + '\r\n')
			}
		}
	}

	// Return config fields for web config
	getConfigFields() {
		return [
			{
				type: 'static-text',
				id: 'important-line',
				width: 12,
				label: 'Information',
				value: 'This module will establish a connection to ClassX MixBoard.',
			},
			{
				type: 'textinput',
				id: 'host',
				label: "MixBoard's IP",
				width: 12,
				regex: this.REGEX_IP,
			},
			{
				type: 'textinput',
				id: 'port',
				label: "MixBoard's command port",
				width: 6,
				regex: this.REGEX_PORT,
			},
			{
				type: 'textinput',
				id: 'eventport',
				label: "MixBoard's event port",
				width: 6,
				regex: this.REGEX_PORT,
			},
			{
				type: 'checkbox',
				id: 'protocollog',
				label: 'Protocol log to console',
				width: 12,
			},
		]
	}
}

runEntrypoint(MixBoardInstance)